(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?module.exports=e(require("https://d3js.org/d3.v4.min")):typeof define==="function"&&define.amd?define(["https://d3js.org/d3.v4.min"],e):t.jelly=e(t.d3)})(this,function(X){"use strict";if(typeof Object.assign!="function"){(function(){Object.assign=function(t){if(t===undefined||t===null){throw new TypeError("Cannot convert undefined or null to object")}var e=Object(t);for(var i=1;i<arguments.length;i++){var r=arguments[i];if(r!==undefined&&r!==null){for(var n in r){if(r.hasOwnProperty(n)){e[n]=r[n]}}}}return e}})()}if(!Array.prototype.find){Array.prototype.find=function(t){if(this==null){throw new TypeError("Array.prototype.find called on null or undefined")}if(typeof t!=="function"){throw new TypeError("predicate must be a function")}var e=Object(this);var i=e.length>>>0;var r=arguments[1];var n;for(var a=0;a<i;a++){n=e[a];if(t.call(r,n,a,e)){return n}}return undefined}}Number.isInteger=Number.isInteger||function(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)===t};if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,"findIndex",{value:function t(e){if(this==null){throw new TypeError("Array.prototype.findIndex called on null or undefined")}if(typeof e!=="function"){throw new TypeError("predicate must be a function")}var i=Object(this);var r=i.length>>>0;var n=arguments[1];var t;for(var a=0;a<r;a++){t=i[a];if(e.call(n,t,a,i)){return a}}return-1},enumerable:false,configurable:false,writable:false})}var u=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var r=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};var n=function(){function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}return function(t,e,i){if(e)r(t.prototype,e);if(i)r(t,i);return t}}();var a=function t(e,i,r){if(e===null)e=Function.prototype;var n=Object.getOwnPropertyDescriptor(e,i);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return t(a,i,r)}}else if("value"in n){return n.value}else{var s=n.get;if(s===undefined){return undefined}return s.call(r)}};var s=function(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof e)}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e};var o=function(t,e){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e&&(typeof e==="object"||typeof e==="function")?e:t};var l="jellychart";var t=["#50C3F7 ","#7986CB ","#BA68C8 ","#F06292 ","#FF8A65 ","#FFD54F ","#AED581 ","#4CB6AC ","#2C82A9 ","#48528A ","#803E8C ","#A6365B ","#CF6644 ","#C1A039 ","#749350 ","#32827A "];var Y=function(){var i=X.format(",");var r=X.format("+,");var n=X.format(",.2f");var a=X.format("+,.2f");return function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isNaN(t))return t;else if(typeof t==="string")t=+t;return(Number.isInteger(t)?e?r:i:e?a:n)(t)}}();function Z(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:l;var r=t.split(" ").map(function(t){return i+"-"+t});if(e)return"."+r.join(".");else return r.join(" ")}function i(i,r){if(i.on&&typeof i.on==="function"){var t=i.on;i.on=function(){var e=void 0;try{e=t.apply(i,arguments)}catch(t){e=r.on.apply(r,arguments)}return e}}else{i.on=function(){var t=r.on.apply(r,arguments);return t===r?i:t}}return i}function v(){try{return/constructor/i.test(window.HTMLElement)||function(t){return t.toString()==="[object SafariRemoteNotification]"}(!window["safari"]||v.pushNotification)}catch(t){return false}}function c(e){return function(t){if(!arguments.length)return this.__attrs__[e];this.__attrs__[e]=t;return this}}function f(t,e){if(!t.__attrs__)t.__attrs__={};e=JSON.parse(JSON.stringify(e));for(var i in e){if(e.hasOwnProperty(i)){t.__attrs__[i]=e[i]}}}function h(t,e){for(var i in e){if(e.hasOwnProperty(i)&&!t.prototype[i]){t.prototype[i]=c(i)}}}function e(i){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return function(t){if(!arguments.length)return this.__attrs__[i];else if(typeof t==="boolean"){if(t)t=r}else if((typeof t==="undefined"?"undefined":u(t))==="object"){for(var e in r){if(r.hasOwnProperty(e)){if(!(e in t))t[e]=r[e]}}}this.__attrs__[i]=t;return this}}function d(t){return X.select("body").selectAll("#"+t).empty()}function A(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=t+e;while(!d(i)){e++;i=t+e}return i}function E(t){return t[0]*t[t.length-1]<0}function _(t){return new p(t)}var p=function(){function e(t){r(this,e);this.parent=t}n(e,[{key:"with",value:function t(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++){i[r]=arguments[r]}return i.reduce(function(t,e){return e(t)},this.parent)}}]);return e}();function m(e){var t=function t(){return new e};t.__class__=e;return t}var g={millisecond:X.timeMillisecond,second:X.timeSecond,minute:X.timeMinute,hour:X.timeHour,day:X.timeDay,week:X.timeWeek,sunday:X.timeSunday,monday:X.timeMonday,tuesday:X.timeTuesday,wednesday:X.timeWednesday,thursday:X.timeThursday,friday:X.timeFriday,saturday:X.timeSaturday,month:X.timeMonth,year:X.timeYear,utcMillisecond:X.utcMillisecond,utcSecond:X.utcSecond,utcMinute:X.utcMinute,utcHour:X.utcHour,utcDay:X.utcDay,utcWeek:X.utcWeek,utcSunday:X.utcSunday,utcMonday:X.utcMonday,utcTuesday:X.utcTuesday,utcWednesday:X.utcWednesday,utcThursday:X.utcThursday,utcFriday:X.utcFriday,utcSaturday:X.utcSaturday,utcMonth:X.utcMonth,utcYear:X.utcYear};function y(t){this.message=t+"is not availabele to select";this.name="NotAvailableSelectorError"}function x(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Unacceptable condtion";this.message=t;this.name="ConditionException"}function k(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Zero in the Denominator of a Fraction";this.message=t;this.name="ZeroDenominator"}var w={sum:X.sum,mean:X.mean,variance:X.variance,min:X.min,max:X.max,median:X.median,extent:X.extent};w.values=function(t){return t};w.count=function(t){return t.length};function b(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"ascending";var r=arguments[1];return function(t,e){if(r){t=t[r];e=e[r]}if(i==="natural")return 0;else if(i==="ascending")return t.getTime()-e.getTime();else return e.getTime()-t.getTime()}}function z(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"ascending";var s=arguments[1];var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:function(t){return t};var l=/(\d+((-|\.)*\d*))/;function c(t,e){if(a==="natural")return 0;else if(a==="ascending")return t-e;else return e-t}function u(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(a==="natural")return 0;if(o&&!i){var r=t.match(l),n=e.match(l);if(r&&n){return c(+r[0],+n[0])||u(t,e,true)}}if(a==="ascending")return t.localeCompare(e);return e.localeCompare(t)}function n(t,e){var i=function t(e){return function(t){if(e instanceof Date&&t instanceof Date)return e-t===0;else return t===e}};var r=s.findIndex(i(t));var n=s.findIndex(i(e));if(a==="descending")return n-r;else return r-n}return function(t,e){var i=void 0;if(!s||s.length===0){i=typeof t==="string"&&typeof e==="string"?u:c}else{i=n}return i(r(t),r(e))}}function N(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"x";var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"y";var r=t.length;var n=1/r;var a=X.sum(t,function(t){return t[e]})*n;var s=X.sum(t,function(t){return t[i]})*n;var o=X.sum(t.map(function(t){return Math.pow(t[e]-a,2)}));var l=X.sum(t.map(function(t){return Math.pow(t[i]-s,2)}));var c=X.sum(t.map(function(t){return(t[e]-a)*(t[i]-s)}));var u=c/o;var f=s-a*u;var h=Math.pow(c,2)/(o*l);return{slope:u,intercept:f,rSquare:h}}function F(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!Array.isArray(e))e=[e];t.forEach(function(i,r,n){e.forEach(function(t){var e=t.valueName();if(r===0)i.data.value[e+"-start"]=0;else i.data.value[e+"-start"]=n[r-1].data.value[e+"-end"];i.data.value[e+"-end"]=i.data.value[e+"-start"]+i.data.value[e]})});if(i){var n={};var r=t[t.length-1].data.value;e.forEach(function(t){var e=t.valueName();n[e]=r[e+"-end"]});t.forEach(function(r){e.forEach(function(t){var e=t.valueName();var i=n[e];if(i!==0){r.data.value[e+"-start"]=r.data.value[e+"-start"]/i;r.data.value[e+"-end"]=r.data.value[e+"-end"]/i}else{throw new k}})})}}function S(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"linear";var i=arguments[2];var r=e==="time"||false;if(!r){r=true;for(var n=0;n<t.length;n++){var a=t[n];if(!(a instanceof Date)){r=false;break}}}var s=void 0;if(r){s=X.scaleTime();e="time"}else{if(e==="pow")s=X.scalePow();else if(e==="log")s=X.scaleLog();else{s=X.scaleLinear();e="linear"}}s._scaleType=e;s._field=i;return s}function T(e,t){if(e.interval){var i=g[e.interval];t.key(function(t){return i(t[e.field])})}else if(e.format){var r=e.format;t.key(function(t){return r(t[e.field])})}else{t.key(function(t){return t[e.field]})}if(e.order==="ascending"||e.order==="descending"){t.sortKeys(z(e.order,e.orderList))}return t}function O(r,n,a){var s=this.dimensions();var o=r;var t=function t(e){var i=n?s[s.length-1-e]:s[e];if(i.interval){o.forEach(function(t){t.key=new Date(t.key)});o.sort(b(i.order,"key"));if(a&&i.format){o.forEach(function(t){t.key=i.format(t.key)})}}if(e<s.length-1)o=X.merge(r.map(function(t){return t.values}))};for(var e=0;e<s.length;e++){t(e)}return r}function P(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var a=arguments[5];var s=arguments[6];var o=this.data();a=a||this.dimensions();s=s||this.measures();var l=X.nest();for(var c=0;c<a.length;c++){var u=t?a[a.length-1-c]:a[c];T(u,l)}if(!e){var f=O.call(this,l.entries(o),t,i);return r?X.hierarchy({values:f},function(t){return t.values}).children:f}l.rollup(function(t){var i={};s.forEach(function(e){i[e.field+"-"+e.op]=w[e.op](t,function(t){return t[e.field]})});return i});var h=l.entries(o);O.call(this,h,t,i);if(r){var d=X.hierarchy({values:h},function(t){return t.values});if(n&&s.length===1){var v=s[0];d.sum(function(t){return t.value?t.value[v.field+"-"+v.op]:0})}return d.children}else{return h}}var D={customDomain:null,level:0,munged:null,target:null,format:null,formatSub:null,field:null};var M=function(){function e(t){r(this,e);f(this,D);this.__execs__={};this.setInit(t,["field","format","formatSub","customDomain"])}n(e,[{key:"setInit",value:function t(e){var i=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(e){r.forEach(function(t){if(e[t])i[t](e[t])})}return this}},{key:"axis",value:function t(e){if(!arguments)return this.__execs__.axis;if(e&&(typeof e==="undefined"?"undefined":u(e))==="object"){if(e!==this.__execs__.axis)this.__execs__.axis=e;e.field=this.mixed?this.concatFields():this.field();e.tickFormat=this.format();e.tickFormatSub=this.formatSub()}return this}},{key:"toObject",value:function t(){return{field:this.field(),format:this.format(),formatSub:this.formatSub(),customDomain:this.customDomain()}}}]);return e}();h(M,D);var L=" ";var C={field:"__--jelly_count_measure--__",op:"count"};var R={field:"__--jelly_mixed_measure--__",op:"mean"};var B={aggregated:false,op:"mean",mixed:false,measures:[]};var j=function(t){s(i,t);function i(t){r(this,i);var e=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));f(e,B);e.setInit(t,["op"]);return e}n(i,[{key:"domain",value:function i(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n=this.level();var a=this.munged();var s=0;var i=[];var o=this.valueName();function l(t,e){t.forEach(function(t){if(e<n){l(t.children,e+1)}else{if(r){i.push(t.data.value[o+"-start"]);i.push(t.data.value[o+"-end"])}else{i.push(t.data.value[o])}}})}l(a,s);i=X.extent(i);if(i[0]===i[1]&&!e){var c=i[0]*.2;i[0]-=c;i[1]+=c}if(t<=0)return i;var u=Math.abs(i[0]-i[1]);u*=t*.5;return[i[0]-u,i[1]+u]}},{key:"concatFields",value:function t(){if(this.mixed()){if(this.measures().length>0)return this.measures().map(function(t){return t.field}).join("-");else return""}else if(this.field()===R.field)return"";else return this.field()}},{key:"valueName",value:function t(){var e=this.field();return e+(this.mixed()||e===R.field&&this.aggregated()?"":"-"+this.op())}},{key:"toObject",value:function t(){var e=a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toObject",this).call(this);e.op=this.op();return e}}]);return i}(M);function I(t){return new j(t)}h(j,B);function V(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var r=this.data();var n=this.dimensions();var a=this.measures();var s=void 0;if(n.length===0){s=a.map(function(e){var t=w[e.op](r,function(t){return t[e.field]});var i={};i.key=e.field;i.value={};i.value[R.field]=t;return i})}else{s=this.aggregate(r,true,false,false);if(t){s=a.map(function(i){var t={};t.key=i.field;t.values=s.map(function(t){var e={};e.key=t.key;e.value={};e.value[R.field]=t.value[i.field+"-"+i.op];return e});return t})}else{s.forEach(function(i){i.values=a.map(function(t){var e={};e.key=t.field;e.value={};e.value[R.field]=i.value[t.field+"-"+t.op];return e});delete i.value})}}if(e){var o=X.hierarchy({values:s},function(t){return t.values});if(i){o.sum(function(t){return t.value?t.value[R.field]:0})}return o.children}else{return s}}var G=20;function H(t){if(!arguments.length)return this.__attrs__.autoResize;if(t){if(!this.__execs__.autoResize){var i=this;var r=true;var n=void 0;this.__execs__.autoResize=function(){if(r&&i.__execs__.canvas){var t=i.__execs__.container.node().getBoundingClientRect();if(!n||n!==t.width){var e=i.transition();i.width(t.width).transition({duration:0,delay:0}).render(true,i.autoResizeSkip()).transition(e);n=t.width}r=false;setTimeout(function(){r=true},G)}}}window.addEventListener("resize",this.__execs__.autoResize)}else{if(this.__execs__autoResize){window.removeEventListener("resize",this.__execs__.autoResize);this.__execs__.autoResize=null}}this.__attrs__.autoResize=t;return this}function W(t){if(!arguments.length)return this.__attrs__.color;if(Array.isArray(t)){this.__attrs__.color=t}else if(typeof t==="string"){this.__attrs__.color=[t]}return this}function K(t){if(!arguments.length)return this.__attrs__.colorDomain;t=t.map(function(t){if(typeof t==="string"||typeof t==="number")return{key:t};return t});this.__attrs__.colorDomain=t;return this}function J(t){if(!arguments.length)return this.__execs__.condition;this.__execs__.condition=t.call(this,this.__attrs__.dimensions,this.__attrs__.measures);return this}var q=140;function U(t,e){e=e||this.muteIntensity();t.transition().duration(q).attr("opacity",e);return this}function Q(t){t.transition().duration(q).attr("opacity",1);return this}function $(t){if(this.__execs__.legend)this.__execs__.legend.demute(t);return this}function tt(i){var t=void 0;if(typeof i==="function"){t=i}else if(typeof i==="string"){t=function t(e){return e.data.key!==i}}else if((typeof i==="undefined"?"undefined":u(i))==="object"&&i.data){t=function t(e){return e.data.key!==i.data.key}}else if((typeof i==="undefined"?"undefined":u(i))==="object"){t=function t(e){return e.data.key instanceof Date?e.data.key-i!==0:false};if(i instanceof Date)return t=function t(e){return e.data.key instanceof Date?e.data.key-i!==0:false};else t=function t(e){return e.data.key!==i}}return t}function et(t){var e=void 0;if(!arguments.length){e=this.filterNodes().classed("mute",false).call(this.demute)}else{e=this.filterNodes(tt(t));if(e.size()>0){e.classed("mute",false).call(this.demute)}}return this}function it(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;t.selectAll(e?this.seriesName():this.nodeName()).classed("mute",false).call(this.demute)}function rt(t){var e=void 0;if(!arguments.length){e=this.filterRegions();it.call(this,e);if(this.seriesName)it.call(this,e,true)}else{e=this.filterRegions(tt(t),true);it.call(this,e);if(this.seriesName)it.call(this,e,true)}return this}var nt=100;function at(e){if(e&&typeof e==="string"){try{return X.timeFormat(e)}catch(t){try{return X.format(e)}catch(t){throw t}}}else if(typeof e==="function"){return e}else{return null}}function st(t){if(typeof t==="string"){return{field:t,order:"natural",max:nt}}else if((typeof t==="undefined"?"undefined":u(t))==="object"){t=Object.assign({},t);if(!t.max)t.max=nt;if(!t.order)t.order="natural";t.format=at(t.format);t.formatSub=at(t.formatSub);return t}}function ot(t){this.__attrs__.dimensions.push(st(t));return this}function lt(t){if(!arguments.length)return this.__attrs__.dimensions;if(!Array.isArray(t)){t=[t]}this.__attrs__.dimensions=t.map(function(t){return st(t)});return this}function ct(t){var e=this.__execs__.scale;if(t in e&&e.hasOwnProperty(t)){return e[t].domain()}else{return null}}function ut(t){var e=this.nodes();if(!t||typeof t!=="function")return e;return e.filter(t)}function ft(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this.regions();if(!t||typeof t!=="function")return i;if(e){i=i.filter(function(){return!X.select(this).classed("facet")})}return i.filter(t)}function ht(){if(this.multiTooltip&&this.multiTooltip())return this;this.__execs__.tooltip.hide();return this}function dt(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=this.offset();var i=this.width()-e.left-e.right;var r=this.height()-e.top-e.bottom;if(t)return[i,r];else return{width:i,height:r}}var vt=54;var _t=162;function pt(t){if(!arguments.length)return this.__attrs__.legend;if(t===true)this.__attrs__.legend={orient:"bottom",align:"start",thickness:vt};else if(t===false)this.__attrs__.legend=null;else if((typeof t==="undefined"?"undefined":u(t))==="object"){if(!t.orient)t.orient="bottom";if(!t.thickness)t.thickness=t.orient==="bottom"||t.orient==="top"?vt:_t;if(!t.align)t.align="start";this.__attrs__.legend=t}return this}function mt(t){var e=function e(t,i,r,n){t=t.slice(0,i);if(r<n)t.forEach(function(t){return t.children=e(t.children,i,r+1,n)});return t};if(!arguments.length){var i=this.__attrs__.limitKeys;if(i){var r=this.__execs__.munged;var n=this.dimensions().length;var a=e(this.aggregated()?r.children:r,i,1,n);if(this.aggregated()){r.children=a;a=r}this.__execs__.munged=a}}else{this.__attrs__.limitRows=t}return this}function gt(t){if(!arguments.length){var e=this.__attrs__.limitRows;if(e){var i=this.data();if(this.aggregated()){i.children=i.children.slice(0,e)}else{i=i.slice(0,e)}this.data(i)}}else{this.__attrs__.limitRows=t}}function yt(t,e,i){if(t[i]&&typeof t[i]==="number")e[i]=t[i]}function xt(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=this.__attrs__.margin;if(!arguments.length)return this.__attrs__.margin;if((typeof e==="undefined"?"undefined":u(e))==="object"){["top","right","left","bottom"].forEach(function(t){return yt(e,i,t)})}return this}function kt(t){if(typeof t==="string"){this.__attrs__.measures.push({field:t,op:"sum"})}else if((typeof t==="undefined"?"undefined":u(t))==="object"){if("format"in t&&typeof t.format==="string")t.format=X.timeFormat(t.format);this.__attrs__.measures.push(t)}return this}function wt(t,e){t=t||this.measures()[0];var i=t.field;if(!this.aggregated()||t.field!==R.field)i+="-"+t.op;return i+(e!==undefined?"-"+e:"")}function bt(t){if(!arguments.length)return this.__attrs__.measures;var e=function t(e){if(typeof e==="string"){return{field:e,op:"sum"}}else if((typeof e==="undefined"?"undefined":u(e))==="object"){if("format"in e&&typeof e.format==="string")e.format=X.timeFormat(e.format);return e}};if(Array.isArray(t)){this.__attrs__.measures=t.map(function(t){return e(t)})}else{this.__attrs__.measures=[e(t)]}return this}function zt(){var t={order:"natural"};t.field=this.measures().map(function(t){return t.field}).join("-");return t}function At(t){if(this.__execs__.legend)this.__execs__.legend.mute(t);return this}function Nt(t){var e=void 0;if(!arguments.length){e=this.filterNodes().classed("mute",true).call(this.mute,this.muteIntensity())}else if(t===null){e=this.filterNodes().classed("mute",false).call(this.demute)}else{e=this.filterNodes(tt(t));if(e.size()>0){e.classed("mute",true).call(this.mute,this.muteIntensity())}}return this}function Ft(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;t.selectAll(i?this.seriesName():this.nodeName()).classed("mute",e).call(e?this.mute:this.demute,this.muteIntensity())}function St(t){var e=void 0;if(!arguments.length){e=this.filterRegions();Ft.call(this,e,true);if(this.seriesName)Ft.call(this,e,true,true)}else if(t===null){e=this.filterRegions();Ft.call(this,e,false);if(this.seriesName)Ft.call(this,e,false,true)}else{e=this.filterRegions(tt(t),true);if(e.size()>0){Ft.call(this,e,true);if(this.seriesName)Ft.call(this,e,true,true)}}return this}function Tt(t){var e=void 0;if(!arguments.length||t===false)return this.__attrs__.nodeName;else if(typeof t==="boolean"&&t){return e?e:e=this.__attrs__.nodeName.split(".").join(" ").trim()}else if(typeof t==="string"){this.__attrs__.nodeName=t;e=this.__attrs__.nodeName.split(".").join(" ").trim()}return this}function Ot(){return this.regions().selectAll(this.nodeName())}var Pt={top:0,right:0,bottom:0,left:0};function Dt(){if(this.zeroOffset())return Pt;var t=Object.assign({},this.zeroMargin()?Pt:this.margin());var e=this.legend();if(e)t[e.orient]+=e.thickness;return t}function Mt(t){if(!arguments.length)return this.__attrs__.parent;this.__attrs__.parent=t;return this}function Lt(t,e,i){return{type:t,call:e,allow:i.allow,isPre:i.isPre}}function Ct(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!this.__process__)this.__process__=[];if(!arguments.length)return this.__process__;var r=this.__process__;if(t&&typeof t==="function"){var n=r.findIndex(function(t){return t.type===e});if(n>=0){r[n]=Lt(e,t,i)}else{r.splice(r.length,0,Lt(e,t,i))}return this}else{return r.find(function(t){return t.type===e})}}function Et(t){return i(this,t)}function Rt(){return this.__execs__.canvas.selectAll(this.regionName())}function Bt(){this.reset();if(this.__execs__.canvas){this.__execs__.canvas.node().parentNode.parentNode.remove();this.__execs__.canvas=null}return this}function jt(t,e){t.on("click.default",function(){e.apply("selectClick",this,arguments)}).on("mouseenter.default",function(){e.apply("selectEnter",this,arguments)}).on("mouseleave.default",function(){e.apply("selectLeave",this,arguments)});return t}function It(t){var e=this;t.forEach(function(t){if(t.allow){if(t.allow.call(e))t.call.call(e)}else{t.call.call(e)}})}function Vt(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r={pre:[],post:[]};this.process().forEach(function(t){if(i.indexOf(t.type)<0){if(t.isPre)r.pre.push(t);else r.post.push(t)}});this.reset(t);this.keep(t);if(this.needCanvas())this.renderFrame();It.call(this,r.pre);if(this.needCanvas())this.renderCanvas();It.call(this,r.post);if(!this.__execs__.canvas)return;var n=this.__execs__.selectDispatch;var a=this.nodes();var s=this.__execs__.legend;if(a&&a.size()>0){if(this.parent()){return}a.call(jt,n).on("mouseenter.default.legend",function(t){if(s&&s.mute&&e.muteToLegend)e.muteToLegend(t)}).on("mouseleave.default.legend",function(t){if(s&&s.demute&&e.demuteToLegend)e.demuteToLegend(t)})}if(this.isFacet&&this.isFacet()){a.call(jt,n)}if(this.stream&&this.stream()&&t){this.stream(null)}return this}var Gt="none";function Ht(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var e=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var n=function t(e){e.attr("x",-r).attr("y",-r).attr("width",i.width+r*2).attr("height",i.height+r*2)};var a=t.selectAll(function(){return this.childNodes}).filter(function(){return X.select(this).classed(Z("canvas-g-defs"))});if(a.empty()){a=t.append("defs").attr("class",Z("canvas-g-defs")).datum(i);a.append("clipPath").attr("id",function(){return A("canvas-g-")}).attr("class",Z("canvas-g-clip-path")).append("rect").attr("class",Z("canvas-g-clip-path-rect")).call(n)}var s=a.select(Z("canvas-g-clip-path-rect",true));if(e)s=s.transition().duration(e.duration).delay(e.delay);s.call(n)}function Xt(t,e,i){var r=i.__execs__.mark;t=X.select(t);if(t.empty())throw new y;if(t.node().tagName==="g"||t.node().tagName==="G"){if(t.select(Z("canvas-g",true)).empty()){i.__execs__.canvas=t.append("g").attr("class",Z("canvas-g"));i.__execs__.canvas.append("g").attr("class",Z("regions"))}else if(!this.__execs__.canvas){i.__execs__.canvas=t.select(Z("canvas-g",true))}r.set(i.__execs__.canvas.node(),{x:e.left,y:e.right});i.__execs__.canvas.attr("transform","translate("+[e.left,e.right]+")")}}function Yt(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var e=this.container();if(e===null)return null;var i=this.offset();var r=this.innerSize();if(typeof e!=="string"){Xt(e,i,this);if(this.__execs__.canvas){this.__execs__.canvas.datum(this.__execs__.munged);this.__execs__.canvas.call(Ht,r,t,this.transition());return}}var n=void 0;if(this.__execs__.canvas){n=X.select(this.__execs__.canvas.node().parentNode)}else{var a=X.select(e);if(a.empty()){throw new y}n=a.select(Z("frame",true)).select("svg");this.__execs__.canvas=n.append("g").attr("class",Z("canvas-g")).attr("transform","translate("+[i.left,i.top]+")");this.__execs__.canvas.append("rect").attr("class",Z("background")).style("fill",Gt);this.__execs__.canvas.append("g").attr("class",Z("regions"))}var s=this.transition();var o=this.__execs__.canvas;o.style("pointer-events","none");if(s){o.transition().duration(s.duration).delay(s.delay).attr("transform","translate("+[i.left,i.top]+")").on("end",function(){X.select(this).style("pointer-events","all")})}else{o.attr("transform","translate("+[i.left,i.top]+")").style("pointer-events","all")}o.select(Z("background",true)).attr("width",r.width).attr("height",r.height);o.datum(this.__execs__.munged).call(Ht,r,t,this.transition());return this}function Zt(t,e){t.attr("width",e.width()).attr("height",e.height()).attr("viewBox","0 0 "+e.width()+" "+e.height());return t}function Wt(t,e){e.__execs__.hidden=t.append("g").attr("class",Z("hidden-g")).style("visibility","hidden");return t}function Kt(){var t=this.container();var e=X.select(t);if(e.empty())throw new y;this.__execs__.container=e;if(typeof t!=="string"){if(e.node().tagName==="g"||e.node().tagName==="G"){if(e.selectAll(Z("hidden-g",true)).empty()){e.call(Wt,this)}else if(!this.__execs__.hidden){this.__execs__.hidden=e.select(Z("hidden-g",true))}return}}var i=void 0;if(!this.__execs__.canvas){i=e.append("div").attr("class",Z("frame"));if(this.name())i.attr("id","jelly-chart-id-"+this.name());i=i.append("svg");i.call(Wt,this);i.call(Zt,this)}else{i=X.select(this.__execs__.canvas.node().parentNode)}if(this.autoResize()){this.width(this.__execs__.container.node().getBoundingClientRect().width)}e.select(Z("frame",true)).style("width",this.width()+"px").style("height",this.height()+"px");if(this.transition())i=i.transition().duration(this.transition().duration).delay(this.transition().delay);i.call(Zt,this);return this}var Jt={"font-family":"sans-serif","font-size":11,"font-weight":"normal","font-style":"normal"};var qt=Z("legend-area-clip-path");var Ut=Z("legend-label-clip-path");var Qt=["start","middle","bottom"];var $t=["top","bottom"];var te=180;var ee={align:Qt[0],color:"#485465",muteIntensity:.3,font:Jt,format:null,height:0,orient:$t[1],scale:null,showTooltip:true,title:null,transition:null,width:0,x:0,y:0};var ie=function t(){r(this,t);this.__attrs__=JSON.parse(JSON.stringify(ee));this.__execs__={legend:null};this.__execs__.dispatch=X.dispatch("selectClick","selectEnter","selectLeave");i(this,this.__execs__.dispatch)};function re(){return new ie}function ne(){return this.orient()==="bottom"||this.orient()==="top"}function ae(t){var e=this.font();for(var i in e){t.style(i,i==="font-size"?e[i]+"px":e[i])}}function se(t){var e=t.select(Z("label-area",true));var i=this.width();var r=this.align();var n=e.node().getBBox().width;var a=0;if(r===Qt[1]){a=Math.round((i-n)/2)}else if(r===Qt[2]){a=i-n}e.attr("transform","translate("+a+",0)");return t}function oe(t,e,i){var r=e.isHorizontal();var n=e.width();var a=e.height();var s=e.labelHeight();var o=e.labelPadding();var l=s+o;var c=X.schemeCategory10[0],u="#A3A3A3";var f=t.select(Z("label-area",true));var h=0;var d=t.selectAll(Z("arrow",true)).data(["up","down"]);var v=d.enter().append("g").attr("class",function(t){return Z("arrow "+t)}).style("cursor","pointer");v.append("rect").attr("width",l).attr("height",l).attr("fill","#fff").attr("stroke",u).attr("stroke-width","1px").attr("shape-rendering","crispEdges");v.append("path").attr("d",X.symbol().type(X.symbolTriangle).size(s*2.5)).attr("transform",function(t,e){var i="translate("+[(l-1)*.5,(l-1)*.5]+")";return i+(e===1?"rotate(180)":"")}).style("display","block").attr("fill",function(t){return t==="up"?u:c});d=v.merge(d).attr("transform",function(t,e){if(r)return"translate("+[n+o,e*(s+o)]+")";else return"translate("+[0,a+o*1.25+e*(s+o)]+")"});d.on("click",function(t){if(t==="up"&&h>0){h-=1}else if(t==="down"&&h<i){h+=1}else{return}d.select("path").style("fill",c).style("cursor","pointer");if(h===0){d.select("path").filter(function(t){return t==="up"}).style("fill",u).style("cursor","default")}else if(h===i){d.select("path").filter(function(t){return t==="down"}).style("fill",u).style("cursor","default")}f.attr("transform","translate("+[0,-h*(s+o)]+")")})}function le(t,e){var i=e.width();var r=e.isHorizontal()?i/2:i;var n=t.selectAll("defs").data([[{name:qt,width:i},{name:Ut,width:r}]]);n=n.enter().append("defs").merge(n);var a=n.selectAll("clipPath").data(function(t){return t},function(t){return t.name});a.exit().remove();a=a.enter().append("clipPath").attr("class",function(t){return t.name}).attr("id",function(t){return A(t.name+"-")}).merge(a);var s=a.selectAll("rect").data(function(t){return[t]});s.exit().remove();s=s.enter().append("rect").merge(s).attr("width",function(t){return t.width}).attr("height",e.height());t.select(Z("label-area-parent",true)).attr("clip-path","url(#"+a.filter(function(t,e){return e===0}).attr("id")+")");t.selectAll(Z("label",true)).attr("clip-path","url(#"+a.filter(function(t,e){return e===1}).attr("id")+")");return t}function ce(t){var s=this.isHorizontal();var o=this.width();var l=s?o/2:o;var c=this.labelHeight();var u=this.labelPadding();var f=0,h=0,d=0;t.call(le,this);t.selectAll(Z("label",true)).each(function(t,e){var i=X.select(this);var r=void 0,n=void 0;var a=Math.min(this.getBBox().width,l);if(e===0||s&&h+a+u*2<=o){r=h;n=d}else{f+=1;r=h=0;n=d=d+c+u}h+=a+u*2;i.attr("transform","translate("+[r,n]+")")});if((f+1)*(c+u)>this.height()){t.call(oe,this,f)}else{t.selectAll(Z("arrow",true)).remove()}}function ue(t){var e=this;this.__execs__.legend=t;var i=t.select(Z("label-area",true));if(this.transition()&&!i.empty()){var r=this.transition();t.transition().duration(r.duration).delay(r.delay).attr("transform","translate("+[this.x(),this.y()]+")")}else{t.attr("transform","translate("+[this.x(),this.y()]+")")}if(i.empty()){i=t.append("g").attr("class",Z("label-area-parent")).append("g").attr("class",Z("label-area"))}var n=this.labelHeight();var a=n/2;var s=this.scale();var o=i.selectAll(Z("label",true)).data(s.domain().filter(function(t){return t!==undefined&&t!==null}).map(function(t){return{key:t,color:s(t)}}));o.exit().remove();var l=o.enter().append("g").attr("class",Z("label")).style("cursor","pointer");l.append("title");l.append("rect").style("fill","none");l.append("circle");l.append("text").style("letter-spacing","-0.1px");o=l.merge(o).style("fill",function(t){return t.color});o.select("title").text(function(t){return e.format()?e.format()(t.key):t.key});o.select("circle").attr("cx",a).attr("cy",a).attr("r",5);o.select("text").attr("x",n).attr("dx",".35em").attr("dy",".9em").style("fill",this.color()).text(function(t){return e.format()?e.format()(t.key):t.key});o.select("rect").attr("width",function(){return this.parentNode.getBBox().width}).attr("height",function(){return this.parentNode.getBBox().height});var c=this.__execs__.dispatch;o.on("click",function(t){c.call("selectClick",this,t)}).on("mouseenter",function(t){c.call("selectEnter",this,t)}).on("mouseleave",function(t){c.call("selectLeave",this,t)})}function fe(t,e){if(typeof e==="function"){return t.filter(e)}else if(typeof e==="string"){return t.filter(function(t){return t.key!==e})}else if(e instanceof Date){var i=e.getTime();return t.filter(function(t){return t.key.getTime()!==i})}else if(e.tagName&&e.tagName==="g"){return t.filter(function(){return this!==e})}return t.filter(function(){return true})}function he(t){fe(this.__execs__.legend.selectAll(Z("label",true)),t).transition().duration(te).attr("opacity",1)}function de(t){var e=fe(this.__execs__.legend.selectAll(Z("label",true)),t);if(e){e.transition().duration(te).attr("opacity",this.muteIntensity())}return this}function ve(){return this.font()["font-size"]}function _e(){return this.isHorizontal()?this.labelHeight()/2:this.labelHeight()}function pe(){}function me(t){ae.call(this,t);ue.call(this,t);ce.call(this,t);se.call(this,t)}ie.prototype.demute=he;ie.prototype.mute=de;ie.prototype.labelHeight=ve;ie.prototype.labelPadding=_e;ie.prototype.render=me;ie.prototype.update=pe;ie.prototype.isHorizontal=ne;h(ie,ee);function ge(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"region";var e=this;var i=this.legend();var r=this.__execs__.canvas;if(!i){r.selectAll(Z("legend",true)).remove();return}var n=this.__execs__.field;if(!i.format&&n[t].isInterval())i.format=n[t].format();var a=void 0,s=void 0,o=void 0,l=void 0;var c=this.offset();var u=this.innerSize();var f=this.margin();var h=i.font?i.font["font-size"]:20;if(i.orient==="bottom"||i.orient==="top"){a=0;if(i.orient==="bottom")s=u.height+c.bottom-f.bottom-i.thickness+h;else s=-c.top+f.top-h;if(this.axisX&&!this.axisX()){s+=h*(i.orient==="bottom"?1:-1)}o=u.width;l=i.thickness-h}else{if(i.orient==="right")a=u.width+c.right-i.thickness;else a=-c.left+f.left-h;s=h/2;o=i.thickness-h;l=u.height-h/2}var d=this.scale().color;var v=re().scale(d).x(a).y(s).align(i.align).width(o).height(l).orient(i.orient).format(i.format).transition(this.transition());this.__execs__.legend=v;v.on("selectEnter",function(t){if(e.muteFromLegend){e.muteFromLegend(t)}v.mute(this);e.__execs__.selectDispatch.call("legendEnter",this,t)}).on("selectLeave",function(t){if(e.demuteFromLegend){e.demuteFromLegend(t)}v.demute(this);e.__execs__.selectDispatch.call("legendLeave",this,t)});var _=r.selectAll(Z("legend",true)).data([v]);_.exit().remove();_.enter().append("g").attr("class",Z("legend")).merge(_).each(function(t){t.render(X.select(this))});return this}function ye(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(t){return t};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var n=this.__execs__.canvas.select(Z("regions",true)).selectAll(this.regionName()+(i?".facet":"")+r).data(e,function(t,e){return t.data&&t.data.key?t.data.key:e});var a=this.regionName().split(".").join(" ").trim();var s=this.aggregated();var o=a+(i?" facet":"");var l=this.__execs__.canvas;var c=X.transition().duration(this.transition().duration).delay(this.transition().delay);var u=l.selectAll(Z("canvas-g-clip-path",true)).attr("id");var f=function t(e){e.each(function(t){if(!s)X.select(this).attr("transform","translate("+[t.x,t.y]+")");else X.select(this).attr("transform","translate(0,0)");if(u&&!i)X.select(this).attr("clip-path","url(#"+u+")")})};var h=function t(e){e.each(function(t){if(!s)X.select(this).transition(c).attr("transform","translate("+[t.x,t.y]+")");else X.select(this).attr("transform","translate(0,0)")})};n.exit().remove();var d=n.enter().append("g").attr("class",o).each(t).call(f);n.each(t);n=d.merge(n);n.call(h);return n}var xe={"font-family":"sans-serif","font-size":11,"font-weight":"normal","font-style":"normal"};var ke="legend-gradient-";var we=["top","bottom"];var be={color:"#6e6e6e",field:null,height:0,orient:we[0],gradientWidth:150,gradientHeight:xe["font-size"],scale:null,showTooltip:true,title:null,width:0,x:0,y:0,font:xe};var ze=function t(){r(this,t);this.__attrs__=JSON.parse(JSON.stringify(be));this.__execs__={spectrum:null,scale:null}};function Ae(){return new ze}function Ne(t){var e=this.font();for(var i in e){t.style(i,i==="font-size"?e[i]+"px":e[i])}}function Fe(t,e,i,r){var n=e;var a=e/n;var s=X.scaleLinear().domain([0,e]).range(r);var o=X.range(0,n).map(function(t){return t*a+a});t.selectAll(Z("gradient-chip",true)).data(o).enter().append("rect").attr("class",Z("gradient-chip")).attr("width",a).attr("height",i).attr("x",function(t){return t-a}).style("fill",function(t){return s(t)})}function Se(t){this.__execs__.spectrum=t.attr("transform","translate("+[this.x(),this.y()]+")");var e=this.scale();var i=e.range();var r=this.gradientWidth();var n=this.gradientHeight();this.__execs__.scale=X.scaleLinear().domain(e.domain()).rangeRound([0,r]);var a=t.select(Z("gradient-area",true));if(a.empty()){var s=A(ke);var o=X.symbol().type(X.symbolTriangle).size(40);a=t.append("g").attr("class",Z("gradient-area"));a.append("path").attr("class",Z("arrow")).attr("fill","#777").attr("d",o).style("visibility","hidden");t.append("defs").append("linearGradient").attr("id",s)}a.attr("transform","translate("+[(this.width()-r)/2,18]+")");var l=t.select("linearGradient");var c=l.selectAll("stop").data(i);c.enter().append("stop").merge(c).attr("offset",function(t,e){return e*100+"%"}).attr("stop-color",function(t){return t});if(v()){a.call(Fe,r,n,i)}else{var u=a.selectAll(Z("gradient-rect",true)).data([e]);u.enter().append("rect").attr("class",Z("gradient-rect")).merge(u).attr("width",this.gradientWidth()).attr("height",this.gradientHeight()).attr("fill","url(#"+l.attr("id")+")")}var f=a.selectAll(Z("label",true)).data(e.domain());f.enter().append("text").attr("class",Z("label")).merge(f).attr("x",function(t,e){return e*r}).attr("y",n).attr("dy","1.25em").attr("text-anchor","middle").style("fill","#999").text(function(t){return Y(t)});var h=this.title()||this.field();h=h.localeCompare(C.field)===0?L:h;var d=a.selectAll(Z("title",true)).data([h]);d.exit().remove();d.enter().append("text").merge(d).attr("class",Z("title")).attr("x",r+this.font()["font-size"]).attr("y",n*.5).attr("dy",".35em").attr("text-anchor","start").text(function(t){return t})}function Te(){this.__execs__.spectrum.select(Z("arrow",true)).style("visibility","hidden");return this}function Oe(){return this.font()["font-size"]}function Pe(){return this.labelHeight()/2}function De(t){var e=this.__execs__.scale(t);this.__execs__.spectrum.select(Z("arrow",true)).style("visibility","visible").attr("transform","translate("+e+",-5)rotate(180)");return this}function Me(){}function Le(t){Ne.call(this,t);Se.call(this,t)}ze.prototype.hide=Te;ze.prototype.labelHeight=Oe;ze.prototype.labelPadding=Pe;ze.prototype.render=Le;ze.prototype.show=De;ze.prototype.update=Me;h(ze,be);function Ce(){var t=this.legend();if(!t)return;var e=this.__execs__.field;var i=void 0,r=void 0,n=void 0,a=void 0;var s=this.offset();if(t.orient==="bottom"){i=0;r=this.innerSize().height+s.bottom-this.margin().bottom-t.thickness;n=this.innerSize().width;a=t.thickness}var o=this.scale().color;var l=Ae().scale(o).field(e.color.field()).x(i).y(r).width(n).height(a);this.__execs__.canvas.selectAll(this.nodeName()+".point").on("mouseenter.spectrum",function(t){l.show(t.value)}).on("mouseleave.spectrum",function(){return l.hide()});this.__execs__.legend=l;var c=this.__execs__.canvas;var u=c.selectAll(Z("spectrum",true)).data([l]);u.exit().remove();u.enter().append("g").attr("class",Z("spectrum")).merge(u).each(function(t){t.render(X.select(this))});return this}var Ee=4;var Re="#001a32";var Be="#fff";var je="#7b92ae";var Ie=(typeof navigator==="undefined"?"undefined":u(navigator))==="object"?/MSIE 9/i.test(navigator.userAgent):false;var Ve={"font-family":"sans-serif","font-size":11,"font-weight":"normal","font-style":"normal"};var Ge={absolute:false,anchor:{x:"left",y:"top"},color:null,dx:0,dy:0,font:Ve,offsetFunc:null,keys:null,keyFunc:null,nodeName:Z("mark node",true),target:null,valueFormat:null,valueFunc:null,values:[],x:0,y:0,fromMulti:false,showDiff:false};var He=function t(){r(this,t);this.__attrs__=JSON.parse(JSON.stringify(Ge));this.__execs__={tooltip:null,mark:null,init:true};this.valueFormat(Y)};function Xe(){return new He}function Ye(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(Ie)return t.style("filter","alpha(opacity="+e*100+")");else return t.style("opacity",e)}function Ze(){var e=this;var t=this.target();var i=t.__execs__.canvas.selectAll(this.nodeName());i.on("mouseleave.tooltip",function(){if(e.fromMulti())return;e.hide()}).on("mouseenter.tooltip",function(t){Ue.call(e,this,t)})}function We(){var t=this.target();var e=t.__execs__.canvas.selectAll(this.nodeName());var i=(t.parent()?t.parent():t).__execs__.canvas.node();var r=X.local();var a=this.offsetFunc();var s=this.absolute();var o=0;var l=0;var n=t.offset();o+=n.left;l+=n.top;if(t.parent()){n=t.parent().offset();o+=n.left;l+=n.top}var c=i.parentNode.getBoundingClientRect();var u=i.parentNode.parentNode.getBoundingClientRect();o+=c.left-u.left;l+=c.top-u.top;o+=Ee;var f=function t(e,i){if(e.x)i.x+=e.x;if(e.y)i.y+=e.y};var h=function t(e){var i={x:o,y:l};if(a&&typeof a==="function"){var r=a.apply(this,arguments);i.x+=r.x;i.y+=r.y}var n=e;if(s){f(n,i)}else{while(n){f(n,i);n=n.parent}}return i};e.each(function(){var t=h.apply(this,arguments);r.set(this,t)});this.__execs__.mark=r}function Ke(t){var e=this.__execs__.tooltip;if(t.style("position")==="static")t.style("position","relative");if(!e||e.empty()){e=t.append("div").attr("class",Z("tooltip")).style("color",Be).style("pointer-events","none").style("background-color",Re).style("padding","9px").style("border-radius","8px").style("position","absolute").style("z-index","999").call(Ye,0);e.append("div").attr("class",Z("keys")).style("padding-bottom","1em").style("letter-spacing","0.1px").call(Ye,.9);e.append("table").attr("class",Z("values")).style("border-collapse","collapse").call(Ye,.72);e.append("div").attr("class",Z("arrow")).style("position","absolute").style("top","calc("+Ee+"px + 50%)").style("left","0%").style("margin",-(Ee*2)+"px").style("border-width",Ee+"px").style("border-style","solid").style("border-color","transparent "+Re+" transparent transparent").text(" ")}for(var i in this.font()){e.style(i,this.font()[i]+(i==="font-size"?"px":""))}this.__execs__.tooltip=e;We.call(this);Ze.call(this)}function Je(){var t=this.__execs__.tooltip;t.transition().duration(180).call(Ye,0)}function qe(t){t=X.select(t);Ke.call(this,t)}function Ue(t,e){if(this.fromMulti())return;var i=this.color();var r=this.keyFunc();var n=this.valueFunc();var a=this.__execs__.mark.get(t);this.x(a.x).y(a.y).color(i?i:e.color).key(r?r.call(this,e,e.key):null).value(n.call(this,e,e.text)).show();return this}function Qe(){var i=this.valueFormat();var t=this.__execs__.tooltip;if(this.keys()){var e=t.select(Z("keys",true)).selectAll(Z("key",true)).data(this.keys());e.exit().remove();e=e.enter().append("div").attr("class",Z("key")).merge(e);e.text(function(t){return t.value})}var r=t.select(Z("values",true)).selectAll(Z("value",true)).data(this.values());r.exit().remove();r=r.enter().append("tr").attr("class",Z("value")).merge(r);if(this.showDiff()&&r.size()>1){r.style("color",function(t,e){return e===0?je:Be})}else{r.style("color",Be)}var n=r.selectAll("td").data(function(t){return[t.name,t.value]});n.exit().remove();n=n.enter().append("td").style("padding",0).style("margin",0).style("padding-bottom",".35em").style("padding-right",function(t,e){return e===0?"2em":0}).style("text-align",function(t,e){return e===0?"left":"right"}).merge(n).text(function(t,e){if(e===0){return t.localeCompare(C.field)===0?L:t}else{return i(t)}});var a=t.node().getBoundingClientRect().height/2;t.style("left",this.x()+this.dx()+"px").style("top",this.y()+this.dy()-a+"px").transition().duration(180).call(Ye,1)}function $e(t){if(!arguments.length||t===null)return this;if("name"in t&&"value"in t)this.__attrs__.keys=[t];return this}function ti(t){if(!arguments.length)return this;if(Array.isArray(t)){this.__attrs__.values=t}else if("name"in t&&"value"in t){this.__attrs__.values=[t]}return this}He.prototype.hide=Je;He.prototype.render=qe;He.prototype.show=Qe;He.prototype.showFromPoint=Ue;He.prototype.key=$e;He.prototype.value=ti;h(He,Ge);function ei(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=Xe().dx(t&&t.dx?t.dx:0).dy(t&&t.dy?t.dy:0).target(this).absolute(i).fromMulti(e);var n=(this.parent()?this.parent():this).__execs__.canvas;if(t.color)r.color(t.color);if(!e){r.keyFunc(t.key).valueFunc(t.value).offsetFunc(t.offset).showDiff(t.showDiff);this.__execs__.tooltip=r}r.render(n.node().parentNode.parentNode);return r}function ii(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.__execs__.axis={};this.__execs__.legend=null;if(!this.parent())this.__execs__.mark=X.local();this.__execs__.regions=null;this.__execs__.nodes=null;if(!t){this.__execs__.scale={};this.__execs__.field={}}if(!this.parent()&&this.__execs__.canvas)X.select(this.container()).selectAll(Z("tooltip",true)).remove();return this}function ri(){var t=this.parent();X.select((t?t:this).__execs__.canvas.node().parentNode.parentNode).selectAll(Z("tooltip",true)).remove();return this}function ni(t){if(!arguments.length)return this.__attrs__.size;if(Array.isArray(t)){this.__attrs__.size={range:t,reverse:false}}else if(typeof t==="number"){this.__attrs__.size={range:[t,t],reverse:false}}else if((typeof t==="undefined"?"undefined":u(t))==="object"){this.__attrs__.size=t}return this}function ai(t){if(!arguments.length)return this.__execs__.scale;return this.__execs__.scale[t]}function si(t){f(this,t);return this}function oi(t,e,i){var r=[];if(i[0]>e[0])r[0]=e[0];else r[0]=i[0];if(i[1]<e[1])r[1]=e[1];else r[1]=i[1];t.domain(r);if(e[0]===r[0]&&e[1]===r[1])t.nice()}function li(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=i?t:this.__execs__.scale[t];var n=i?null:this.__execs__.field[t];r._defaultDomain=e;if(i){r.domain(e).nice()}else if(this.customDomain()){oi(r,e,this.customDomain())}else if((this.isMixed?!this.isMixed():true)&&n.customDomain()){oi(r,e,n.customDomain())}else{r.domain(e).nice()}return this}function ci(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++){n[e]=arguments[e]}if(this.multiTooltip&&this.multiTooltip())return;var i=function t(e){var i=true;var r=e;n.forEach(function(t){i=i&&r.data.key===t;if(r.parent)r=r.parent;else return i});return i};var r=this.filterNodes(i);var a=this.__execs__.tooltip;if(r.size()>0){r.each(function(t){a.showFromPoint(this,t)})}return this}function ui(t,e){e=e||this.font();for(var i in e){if(!t.selectAll)t=X.select(t);t.style(i,e[i]+(i==="font-size"?"px":""))}}function fi(t){if(!arguments.length)return this.__attrs__.tooltip;if(typeof t==="boolean"){if(t){t={sortByValue:"natural"}}}if((typeof t==="undefined"?"undefined":u(t))==="object"){if(!t.sortByValue)t.sortByValue="natural"}this.__attrs__.tooltip=t;return this}function hi(r,n){var a=0;r=r.map(function(t){if(t===undefined){var e=function t(){var e=n[a];a+=1;if(r.findIndex(function(t){return t==e})<0){return{v:e}}};while(a<n.length){var i=e();if((typeof i==="undefined"?"undefined":u(i))==="object")return i.v}}return t});return r.filter(function(t){return t!==undefined})}function di(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=this.scale().color;if(this.colorDomain()&&this.colorDomain().length>0){var r=this.colorDomain();var n=this.color();var a=t.map(function(e){var t=r.findIndex(function(t){return e==t.key});if(t>=0){return r[t].color?r[t].color:n[t]}else{return undefined}});a=hi(a,n);var s=X.scaleOrdinal().domain(t).range(a);s._defaultRange=this.color();return s}else if(e&&i&&this.color()===i._defaultRange){var o=this.color();var l=this.scale().color.domain();var c=this.scale().color.range();var u=false;var f=t.map(function(e){var t=l.findIndex(function(t){return t===e});if(!u&&t>=0)u=true;return t});if(u){var h=f.map(function(t){if(t>=0&&t<c.length){return c[t]}else{return undefined}});h=hi(h,o);return i.domain(t).range(h)}}var d=X.scaleOrdinal().domain(t).range(this.color());d._defaultRange=this.color();return d}var vi={"font-family":"sans-serif","font-size":12,"font-weight":"lighter","font-style":"normal"};var _i=["#ece7f2","#50C3F7"];var pi=t;var mi={autoResize:false,autoResizeSkip:["munge","domain"],aggregated:false,color:pi,colorDomain:null,container:null,customDomain:null,data:[],dimensions:[],font:vi,height:480,keep:false,label:null,legend:null,limitKeys:200,limitRows:1e3,name:null,nodeName:Z("mark node",true),needCanvas:true,margin:{top:40,right:40,bottom:40,left:40},measures:[],muteIntensity:.3,parent:null,regionName:Z("mark region",true),size:null,tooltip:true,transition:{duration:600,delay:20},width:640,zeroOffset:false,zeroMargin:false};var gi=function t(){r(this,t);this.setAttrs(mi);this.__execs__={autoResize:false,axis:{},condition:null,canvas:null,hidden:null,field:{},legend:null,mark:X.local(),scale:{},tooltip:null,regions:null,nodes:null};this.on=undefined;this.__execs__.selectDispatch=X.dispatch("selectClick","selectEnter","selectLeave","legendEnter","legendLeave");this.rebindOnMethod(this.__execs__.selectDispatch)};gi.prototype.font=e("font",vi);gi.prototype.transition=e("transition",mi.transition);gi.prototype.aggregated=c("aggregated");gi.prototype.autoResizeSkip=c("autoResizeSkip");gi.prototype.container=c("container");gi.prototype.customDomain=c("customDomain");gi.prototype.data=c("data");gi.prototype.height=c("height");gi.prototype.keep=c("keep");gi.prototype.label=c("label");gi.prototype.name=c("name");gi.prototype.needCanvas=c("needCanvas");gi.prototype.muteIntensity=c("muteIntensity");gi.prototype.regionName=c("regionName");gi.prototype.width=c("width");gi.prototype.zeroOffset=c("zeroOffset");gi.prototype.zeroMargin=c("zeroMargin");gi.prototype.aggregate=P;gi.prototype.aggregateMixed=V;gi.prototype.autoResize=H;gi.prototype.color=W;gi.prototype.colorDomain=K;gi.prototype.condition=J;gi.prototype.demute=Q;gi.prototype.demuteLegend=$;gi.prototype.demuteNodes=et;gi.prototype.demuteRegions=rt;gi.prototype.dimension=ot;gi.prototype.dimensions=lt;gi.prototype.domain=ct;gi.prototype.filterNodes=ut;gi.prototype.filterRegions=ft;gi.prototype.hideTooltip=ht;gi.prototype.innerSize=dt;gi.prototype.legend=pt;gi.prototype.limitKeys=mt;gi.prototype.limitRows=gt;gi.prototype.margin=xt;gi.prototype.mixedDimension=zt;gi.prototype.measure=kt;gi.prototype.measureName=wt;gi.prototype.measures=bt;gi.prototype.mute=U;gi.prototype.muteLegend=At;gi.prototype.muteNodes=Nt;gi.prototype.muteRegions=St;gi.prototype.nodeName=Tt;gi.prototype.nodes=Ot;gi.prototype.offset=Dt;gi.prototype.parent=Mt;gi.prototype.process=Ct;gi.prototype.tooltip=fi;gi.prototype.scale=ai;gi.prototype.styleFont=ui;gi.prototype.rebindOnMethod=Et;gi.prototype.regions=Rt;gi.prototype.remove=Bt;gi.prototype.render=Vt;gi.prototype.renderCanvas=Yt;gi.prototype.renderFrame=Kt;gi.prototype.renderLegend=ge;gi.prototype.renderRegion=ye;gi.prototype.renderSpectrum=Ce;gi.prototype.renderTooltip=ei;gi.prototype.reset=ii;gi.prototype.resetTooltip=ri;gi.prototype.size=ni;gi.prototype.setAttrs=si;gi.prototype.setCustomDomain=li;gi.prototype.showTooltip=ci;gi.prototype.updateColorScale=di;var yi=14;var xi=18;var ki=18;var wi=Y;var bi=["x","y"];var zi=["top","right","bottom","left"];var Ai=X.format(".2s");var Ni=X.format(",");var Fi={"font-family":"sans-serif","font-size":10,"font-weight":"normal","font-style":"normal","letter-spacing":"0.1px"};var Si=13;var Ti="#c0ccda";var Oi="#485465";var Pi="#3d4145";var Di="#aaa";var Mi=45;var Li=300;var Ci={autoTickFormat:true,autoRotate:true,color:"#7b92ae",field:null,facet:null,font:Fi,format:null,grid:false,gridSize:0,interval:null,orient:zi[2],scale:null,showTitle:true,showDomain:true,showTicks:true,thickness:40,target:bi[0],tickFormat:null,tickFormatSub:null,title:"",titleOrient:null,ticks:null,tickRotate:0,tickSize:0,tickPadding:20,transition:null,x:0,y:0,domainColor:Ti,showAxisLine:true,gridColor:Pi};var Ei=function t(){r(this,t);this.__attrs__=JSON.parse(JSON.stringify(Ci));this.__execs__={axis:null,canvas:null,rotated:false}};function Ri(){return new Ei}function Bi(){return this.orient()==="bottom"||this.orient()==="top"}function ji(){var t=this.orient();var e=this.scale();var i=void 0;if(t===zi[0])i=X.axisTop();else if(t===zi[1])i=X.axisRight();else if(t===zi[3])i=X.axisLeft();else i=X.axisBottom();this.__execs__.axis=i;if(e)i.scale(e);if(this.transition()){var r=this.transition();this.__execs__.transition=X.transition().duration(r.duration).delay(r.delay)}}function Ii(t,e){if(this.grid()&&this.gridSize()>0){var i=this.__execs__.axis;var r=this.gridSize();var n=this.isHorizontal();var a=this.orient();var s=n?"y2":"x2";var o=a==="left"||a==="top"?1:-1;var l=this.scale();var c=t.selectAll(".grid").data(l.ticks(i._tickNumber).map(function(t){return l(t)}));c.exit().remove();var u=c.enter().append("g").attr("class","grid");u.append("line").style("stroke",this.gridColor());c=u.merge(c);if(this.transition()&&!e){c=c.transition(this.__execs__.transition)}c.attr("transform",function(t){return"translate("+(n?[t+.5,0]:[0,t-.5])+")"}).select("line").attr(s,o*r)}else{t.selectAll(".grid").remove()}}function Vi(u){var f=this;var h=this.scale();var t=this.orient();var r=function(){if(h.bandwidth){var t=h.bandwidth();if(t===0)return h.step();return h.bandwidth()}else{var e=h.ticks();if(e.length>1){return Math.abs(h(e[1])-h(e[0]))}else{return Math.abs(h.range[h.range().length-1]-h.range()[0])}}}();var e=function t(){u.selectAll(".tick").each(function(){var t=X.select(this);var e=t.select("title");if(e.empty())e=t.insert("title",":first-child");var i=t.select("text").text();e.text(i)})};var i=function t(){var e=f.showTicks();var i=r<f.font()["font-size"]*(f.isHorizontal()?1:.72);u.selectAll(".tick").style("visibility",i&&h.bandwidth?"hidden":e?"inherit":"hidden")};var n=function t(){var n=f.tickPadding();var a=f.tickRotate();var s=f.isHorizontal();var o=f.orient()==="right"||f.orient()==="top";var e=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;var r=void 0;if(s)r=[0,n/2];else r=[e.attr("x")*.71,0];if(f.transition())e=e.transition().duration(180);e.attr("transform","translate("+r+") rotate("+i*-1+")").attr("text-anchor",s?"start":"end").attr("text-anchor",o?"start":"end")};if(a!==0){u.selectAll(".tick > text").call(e);f.__execs__.rotate=true;return}else if(f.autoRotate()){var i=u.selectAll(".tick");var r=0;i.each(function(){var t=this.getBBox().width;if(X.select(this).selectAll("text").classed(Z("rotated")))t*=1.25;r+=t});var l=r>=Math.abs(h.range()[1]-h.range()[0]);if(s){if(l){i.selectAll("text").classed(Z("rotated"),true).call(e,Mi)}else{var c=i.selectAll("text"+Z("rotated",true)).classed(Z("rotated"),false);if(f.transition())c=c.transition().duration(180);c.attr("transform",null).attr("text-anchor","middle")}}}};e();n();i()}function Gi(t){if(typeof t[0]==="number"&&t[1]>=1e5&&Math.abs(t[1]-t[0])>=1e3)return Ai;else return Ni}function Hi(){var t=this.__execs__.axis;var e=this.tickFormat();var i=this.scale();if(e){if(typeof e==="function")t.tickFormat(function(t){if(typeof t==="string"&&isNaN(t))return t;return e(t)});else if(i.domain()[0]instanceof Date||i._scaleType==="time")t.tickFormat(X.timeFormat(e));else t.tickFormat(X.format(e))}else if(this.autoTickFormat()){if(i.invert&&i.domain()[0]instanceof Date){return}var r=i.domain();if(i.invert&&!i.padding){t.tickFormat(Gi(r))}else{t.tickFormat(function(t){return Y(t)})}}}function Xi(t,e){var i=t.range();e=e||Math.abs(i[1]-i[0]);var r=t.ticks().length;if(e<=Li/2){r=2}else if(e<=Li){r=5}else{r=Math.round(r/2)}return r}function Yi(t){var e=this.__execs__.axis;var i=this.font();var r=this.scale();e.tickSize(this.tickSize()).tickPadding(this.tickPadding()+(this.isHorizontal()?4:2));if(this.ticks()){e.ticks(this.ticks());e._tickNumber=this.ticks()}else if(r.invert){if(r._scaleType==="time"||r.domain()[0]instanceof Date){var n=g[this.interval()];if(n&&!this.autoTickFormat()&&this.tickFormat()){e.ticks(n);e._tickNumber=r.ticks(n).length}else{var a=this.tickFormat();if(a){e._tickNumber=X.set(r.ticks().map(a)).values().length;e.ticks(e._tickNumber)}else{e._tickNumber=r.ticks().length}}}else{var s=Xi(r);e.ticks(s);e._tickNumber=s}}else{e._tickNumber=r.domain().length}for(var o in i){if(o!=="fill")t.style(o,o==="font-size"?i[o]+"px":i[o])}}function Zi(t,e){var i=this;var r=this.__execs__.axis;if(t.selectAll(".domain").size()===0){t.attr("transform","translate("+[this.x(),this.y()]+")")}if(this.transition()&&!e){t.transition(this.__execs__.transition).attr("transform","translate("+[this.x(),this.y()]+")").call(function(t){r(t)}).on("end",function(){Vi.call(i,t)})}else{t.attr("transform","translate("+[this.x(),this.y()]+")").call(r);Vi.call(this,t)}}function Wi(t){var i=this;var r=this.scale();if(this.showTicks()&&this.tickFormatSub()&&r.invert){var e=this.tickFormatSub();var n=this.__execs__.transition;var a=function t(e){return e.attr("x",function(t){return r(t[0])}).attr("y",i.thickness()).attr("dy","-3em")};var s=[];var o=r.ticks(r._tickNumber);var l=o.map(r.tickFormat(r._tickNumber,e)).map(function(t){if(s.indexOf(t)<0){s.push(t);return t}else{return""}});var c=X.zip(o,l).filter(function(t){return t[1]!==""});var u=t.selectAll(".tick-sub-text").data(c,function(t){return t[1]});u.exit().transition(n).attr("opacity",0).remove();u=u.enter().append("text").attr("class","tick-sub-text").text(function(t){return t[1]}).attr("opacity",0).call(a).merge(u);u.transition(n).call(a).attr("opacity",1)}else{t.selectAll(".tick-sub-text").remove()}}function Ki(t){var e=t.selectAll(".tick");e.select("line").style("stroke",this.color());e.select("text").style("fill",this.font()["fill"]?this.font()["fill"]:this.color());t.select(".domain").style("stroke",this.domainColor()).style("shape-rendering","crispEdges").style("stroke-width","1px").style("stroke-opacity",this.showAxisLine()?1:0).style("visibility",this.showDomain()?"visible":"hidden");t.selectAll(".tick-sub-text").style("fill",this.color())}function Ji(t){var r=this;var e=function t(e){if(r.isHorizontal()){e.attr("dy",a==="bottom"?"-1em":".71em")}else{if(s==="bottom"||s==="top"){e.attr("dy",s==="bottom"?"2em":"-1em")}}};var i=function t(e){if(r.isHorizontal()){var i=0;e.attr("transform","translate("+[l,a==="bottom"?r.thickness()-i:-r.thickness()+i]+")")}else{if(s==="bottom"||s==="top"){e.attr("transform","translate("+[0,s==="bottom"?X.max(o.range()):X.min(o.range())]+")")}else{e.attr("transform","translate("+[r.thickness()*(a==="left"?-1:1),l]+") "+(a==="left"?"rotate(90)":"rotate(-90)"))}}};var n=this.title()||this.field();if(!n)return;n=n.localeCompare(C.field)===0?L:n;if(!this.showTitle()){t.selectAll(".title").remove();return}var a=this.orient();var s=this.titleOrient()||a;var o=this.scale();var l=(o.range()[0]+o.range()[1])/2;var c=t.selectAll(".title").data([n]);c.exit().remove();var u=c.enter().append("g").attr("class","title").call(i);u.append("text").attr("text-anchor","middle").style("font-size",Si+"px").style("fill",Oi).call(e);c=u.merge(c);c.select("text").text(n);if(this.transition()){c.transition(this.__execs__.transition).call(i)}}function qi(t,e){var i=this.scale();if(i.invert&&E(i.domain())){var r=this.gridSize();var n=this.isHorizontal();var a=this.orient();var s=n?"y2":"x2";var o=a==="left"||a==="top"?1:-1;var l=this.scale();var c=[];t.selectAll(".tick").filter(function(t){return t===0}).each(function(t){c.push(l(t))});var u=t.selectAll(".zero.grid").data(c);u.exit().remove();var f=u.enter().append("g").attr("class","grid zero");f.append("line").style("stroke",Di);u=f.merge(u);if(this.transition()&&!e){u=u.transition(this.__execs__.transition)}u.attr("transform",function(t){return"translate("+(n?[t+.5,0]:[0,t-.5])+")"}).select("line").attr(s,o*r)}}function Ui(t){if(!arguments.length)return this.__attrs__.facet;if(zi.includes(t))this.__attrs__.facet={orient:t};else this.__attrs__.facet={orient:zi[0]};return this}function Qi(){}function $i(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(t){this.__execs__.canvas=t}else if(this.__execs__.canvas){t=this.__execs__.canvas}else{return}ji.call(this);Hi.call(this);Yi.call(this,t);Zi.call(this,t,e);Wi.call(this,t);Ki.call(this,t);Ii.call(this,t,e);qi.call(this,t,e);Ji.call(this,t)}Ei.prototype.facet=Ui;Ei.prototype.render=$i;Ei.prototype.update=Qi;Ei.prototype.isHorizontal=Bi;h(Ei,Ci);function tr(t){var e=Object.assign({},t);if(e.orient&&e.orient==="x"){e.target=e.orient;e.orient="bottom"}else if(e.orient&&e.orient==="y"){e.target=e.orient;e.orient="left"}var i=e.target==="x";if(!("showDomain"in e))e.showDomain=true;if(!("showTicks"in e))e.showTicks=true;if(!("showTitle"in e))e.showTitle=true;if(!("orient"in e))e.orient=i?"bottom":"left";if(!("thickness"in e)){e.thickness=i?ki:xi;e.thickness+=e.tickPadding?e.tickPadding:0;e.thickness+=e.showTitle?yi*2:0;e.thickness+=e.showTicks?yi:0;e.defaultThickness=e.thickness}if(!("autoTickFormat"in e)&&!("format"in e))e.autoTickFormat=false;return e}function er(t){var e=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var r=void 0;if(!arguments.length)return this.__attrs__.axis;if(Array.isArray(t)){this.__attrs__.axis=t.map(tr);t.forEach(function(t){return e.__execs__.axis[t.target]={}});return this}else if(typeof t==="string"){r={target:t};r=tr(r)}else if((typeof t==="undefined"?"undefined":u(t))==="object"){r=Object.assign({},t);r=tr(r)}var n=this.__attrs__.axis.findIndex(function(t){return t.target===r.target&&t.orient===r.orient});if(i){if(n>=0){this.__attrs__.axis.splice(n,1,r)}else{this.__attrs__.axis.push(r)}if(!this.__execs__.axis[r.target])this.__execs__.axis[r.target]={}}else{if(n>=0){this.__attrs__.axis.splice(n,1)}}return this}function ir(t,e,i){if(!arguments.length)return this.__execs__.axis;this.__execs__.axis[t]=this.__execs__.axis[t]||{};this.__execs__.axis[t][e]=i;return this}function rr(t,e,i){if(t[i]!==undefined)e[i](t[i])}function nr(t,e){var i=this.axisTitles().filter(function(t){return t.target===e.target&&(!t.field||t.field===e.field)&&(!t.shape||t.shape===e.shape)});if(i.length>0)i=i[0];else i=null;var r=Ri();r.scale(t).target(e.target).field(e.field).orient(e.orient).tickFormatSub(e.tickFormatSub).tickFormat(e.tickFormat).title(i?i.title:e.title).titleOrient(e.titleOrient).autoTickFormat(e.autoTickFormat).transition(this.transition());if(t._field){var n=t._field;if(n.interval&&n.interval())r.interval(n.interval());if(n.format&&n.format()&&!e.autoTickFormat)r.tickFormat(n.format());else if(e.autoTickFormat)r.tickFormat(null)}else r.interval(null);["tickPadding","thickness","showTitle","showDomain","showTicks","font","domainColor","showAxisLine","gridColor","tickSize"].forEach(function(t){return rr(e,r,t)});ir.call(this,e.target,e.field,r);return r}function ar(){return this.axis().find(function(t){return t.target==="x"})}function sr(){return this.axis().find(function(t){return t.target==="y"})}function or(t,e){var i=void 0;if(typeof t==="string"){var r=t.split(".");i={target:r[0],field:r.length>=2?r.slice(1).join("."):null}}else if((typeof t==="undefined"?"undefined":u(t))==="object"){i=t}else{throw new Error(".axisTitle: "+t+" is not unavailable")}var n=this.axisTitles();var a=-1;for(var s=0;s<n.length;s++){var o=n[s];if(o.field===i.field&&o.target===i.target){a=s;break}}if(e){var l=Object.assign({},i);l.title=e;if(a>=0)n.splice(a,1,l);else n.push(l)}else{n.splice(a,1)}return this}function lr(){var r=this;var n=this.__execs__.canvas;var a=this.__execs__.axis;var s=function t(e,i,r){var n="axis target-"+i.target()+" orient-"+i.orient()+" targetNum-"+r;var a=e.selectAll(Z(n,true)).data([r]);a.exit().remove();a=a.enter().insert("g",":first-child").attr("class",Z(n)).merge(a).classed(Z("active"),true);i.render(a)};var t=n.selectAll(Z("axis",true));t.classed(Z("active"),false);for(var o in a){if(a.hasOwnProperty(o)){(function(){var e=0;for(var t in a[o]){if(a[o].hasOwnProperty(t)){var i=a[o][t];if(i.facet()){n.selectAll(r.regionName()).call(s,i,e)}else{n.call(s,i,e)}}e+=1}n.selectAll(Z("axis target-"+o,true)).filter(function(t){return t>=e}).remove()})()}}t.filter(function(){return!X.select(this).classed(Z("active"))}).remove();return this}function cr(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var n=this.__execs__.hidden;if(!(t&&t.showTicks)||t&&t.autoTickFormat)return;var a=t.font||Fi;var s=t.tickFormat||(r?wi:t.autoTickFormat&&Gi(e.domain()));var o=r?e.domain():e.ticks();if(e._field){var l=e._field;if(l.format()&&!t.autoTickFormat)s=l.format();if(l.interval&&l.interval())o=e.ticks(g[e._field.interval()])}var c=-1;var u=false;var f=this.innerSize();var h=i?f.width/o.length:0;var d=n.selectAll(Z("tick",true)).data(s?o.map(s):o);d=d.enter().append("text").attr("class",Z("tick")).merge(d).text(function(t){return t});this.styleFont(d,a);d.each(function(){var t=this.getBBox().width;if(t>c)c=t;if(t>h)u=true});c=c+yi;if(t.tickPadding)c+=t.tickPadding;if(t.showTitle)c+=yi;if(t.thickness)c+=yi;if(t.defaultThickness){if(u&&c>t.defaultThickness){t.thickness=c}else if(t.defaultThickness<t.thickness){t.thickness=t.defaultThickness}}if(t.target==="x"){t.thickness=Math.min(t.thickness,this.height()*.5)}else{t.thickness=Math.min(t.thickness,this.width()*.8)}d.remove();t.thickness=Math.round(t.thickness);return t.thickness}var ur={axis:[],axisTitles:[],grid:false,noAxisOffset:false};var fr=function(t){s(i,t);function i(){r(this,i);var t=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));t.setAttrs(ur);return t}n(i,[{key:"offset",value:function e(){var e=a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"offset",this).call(this);e=Object.assign({},e);var t=this.axis();if(!this.noAxisOffset()){t.forEach(function(t){e[t.orient]+=t.thickness})}return e}}]);return i}(gi);fr.prototype.axisTitles=c("axisTitles");fr.prototype.axisToggle=c("axisToggle");fr.prototype.grid=c("grid");fr.prototype.noAxisOffset=c("noAxisOffset");fr.prototype.axis=er;fr.prototype.axisX=ar;fr.prototype.axisY=sr;fr.prototype.axisDefault=nr;fr.prototype.axisTitle=or;fr.prototype.renderAxis=lr;fr.prototype.thickness=cr;fr.prototype.downArrowPath=c("down-arrow");fr.prototype.upArrowPath=c("up-arrow");function hr(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var e=this.facet();var i=this.__execs__.field;var r=this.axisX();var n=this.axisY();var a=this.__execs__.scale;var s=this.innerSize();if(e.orient==="horizontal"&&r){i[t?"region":"x"].axis(r);r.orient="top";r.showDomain=false;this.axisDefault(a.region,r)}else if(e.orient==="vertical"&&n){i[t?"region":"x"].axis(n);n.orient="right";n.showDomain=false;this.axisDefault(a.region,n).x(s.width)}return this}var dr=["vertical","horizontal"];function vr(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!arguments.length)return this.__attrs__.facet;if(!t)this.__attrs__.facet=false;else if(dr.includes(t))this.__attrs__.facet={orient:t};else this.__attrs__.facet={orient:dr[0]};return this}var _r={facet:false};var pr=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(_r);return t}return e}(fr);pr.prototype.axisFacet=hr;pr.prototype.facet=vr;var mr={padding:0,regionPadding:0};var gr=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(mr);return t}return e}(e);i.prototype.padding=c("padding");i.prototype.regionPadding=c("regionPadding");h(i,mr);return i};function yr(e){if(!arguments.length)return this.__attrs__.sortByValue;if(e&&(typeof e!=="string"||!xr.find(function(t){return t===e}))){e="natural"}this.__attrs__.sortByValue=e;return this}var xr=["natural","ascending","descending"];var kr={sortByValue:xr[0]};var wr=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(kr);return t}return e}(e);i.prototype.sortByValue=yr;return i};var br={stacked:false,normalized:false};var zr=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(br);return t}return e}(e);i.prototype.stacked=c("stacked");i.prototype.normalized=c("normalized");return i};function Ar(t){return t(t.domain()[0])-t(t._lastDomain[0])}function Nr(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=this.viewInterval();var n=r?r.unit:e.length;var a=r?r.multiple:1;var s=typeof n==="undefined"?"undefined":u(n);t._defaultDomain=e;if(i)t._lastDomain=t.domain();if(t.invert){if(s==="string"&&e[0]instanceof Date){if(i){e=[g[n].offset(e[e.length-1],-1*a),e[e.length-1]]}else{e=[e[0],g[n].offset(e[0],1*a)]}}else if(s==="number"){if(i){e=[e[e.length-1]-n*a,e[e.length-1]]}else{e=[e[0],e[0]+n*a]}}}else{if(s==="number"){if(i){var o=e.length-n*a;e=e.slice(o,o+n*a)}else{e=e.slice(0,n*a)}}}return e}function Fr(t){if(!arguments.length)return this.__execs__.stream;if(t){if(!Array.isArray(t))t=[t];this.data(this.data().concat(t))}this.__execs__.stream=t;return this}function Sr(t){var e=+t.invert(t.range()[0]+1);var i=+t.invert(t.range()[0]);return e-i}function Tr(o,n){var a=this;var t=this.__execs__.streamPanning;if(!t){t=X.drag();var e=this.__execs__.field;var i=this.__execs__.axis;var s=i&&i.x?i.x[e.x.field()]:null;var r=this.__execs__.canvas;var l=this.process().find(function(t){return t.type==="mark"}).call;var c=this.process().find(function(t){return t.type==="tooltip"}).call;var u="invert"in o;var f=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;o._lastDomain=e;o.domain(e);var r=a.transition();a.transition({duration:i,delay:0});if(n)n();l.call(a);a.resetTooltip();c.call(a);s.render(null,true);a.transition(r)};this.__execs__.streamPanning=t;if(u){var h=o.domain()[0]instanceof Date;t.on("drag.streamPanning",function(){var t=o.domain();var e=Sr(o);var i=o._defaultDomain;var r=X.event.dx*-1;var n=e*r;var a=r>0&&+t[t.length-1]+n<=+i[i.length-1]||r<0&&+t[0]+n>=+i[0];if(a){f(t.map(function(t){return h?new Date(+t+n):t+n}))}})}else{var d=0;t.on("start.streamPanning end.streamPanning",function(){d=0}).on("drag.streamPanning",function(){var t=o.step();d+=X.event.dx;var e=Math.abs(d);if(e>=o.step()){var i=o.domain();var r=o._defaultDomain;var n=r.findIndex(function(t){return t===i[0]});var a=Math.floor(e/t);a*=d>0?-1:1;var s=a>0&&n+i.length+a<r.length||a<0&&n+a>=0;if(s){f(r.slice(n+a,n+i.length+a),400)}d=0}})}r.call(t)}return this}function Or(e,i){var t=i._defaultDomain.findIndex(function(t){return t===i.domain()[0]});var r=i._defaultDomain.findIndex(function(t){return t===e});var n=r-t;if(n>=0){n=n-i.domain().length;return i.range()[1]+n*i.step()}else{return i.range()[0]+n*i.step()}}function Pr(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(!arguments.length)return this.__execs__.viewInterval;var i=typeof t==="undefined"?"undefined":u(t);if(i==="number"){if(Pr<=0)t=null}else if(i==="string"){if(!Object.keys(g).includes(t)){t=null}}if(t)this.__execs__.viewInterval={unit:t,multiple:e};else this.__execs__.viewInterval=null;return this}var Dr={viewInterval:null,stream:null};var Mr=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(Dr);t.__execs__.viewInterval=null;t.__execs__.stream=null;t.__execs__.streamPanning=null;t.__execs__.streamPanningDispatch=X.dispatch("streamPanning");t.rebindOnMethod(t.__execs__.streamPanningDispatch);return t}return e}(e);i.prototype.distDomain=Ar;i.prototype.limitViewInterval=Nr;i.prototype.stream=Fr;i.prototype.streamPanning=Tr;i.prototype.tempPosForOrdinalScale=Or;i.prototype.viewInterval=Pr;return i};function Lr(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;t.attr("transform",function(t){if(i){if(r)return"translate("+[e.width,e.height]+")";return"translate("+[e.width,t.y-.5]+")"}else{if(r)return"translate("+[0,0]+")";return"translate("+[t.w+.5,0]+")"}})}function Cr(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(i){t.attr("x1",-e.width)}else{t.attr("y2",e.height)}}function Er(){if(!this.annotation()||this.isFacet()||this.stacked())return;var t=this.annotation();var e=this;var i=this.__execs__.canvas;var r=X.transition().duration(this.transition().duration).delay(this.transition().delay);var n=this.innerSize();var a=this.isVertical();var s=this.showDiff()&&!this.isNested();if(i.select(".annotation-g").empty())i.append("g").attr("class","annotation-g");var o=i.select(".annotation-g");var l=o.selectAll(".annotation").data(this.nodes().data());l.exit().remove();var c=l.enter().append("g").attr("class","annotation").call(Lr,n,a,true).style("pointer-events","none");c.append("text").style("fill",t.color);c.append("line").style("stroke",t.color).style("shape-rendering","crispEdges").call(Cr,n,a);l=c.merge(l).transition(r).call(Lr,n,a);if(s){l.style("visibility",function(t,e,i){if(t.diff){if(t.diff.value<0)return"visible";else if(e<l.size()-1&&X.select(i[e+1]).datum().diff.value>0)return"visible";if(t.neighbor.diff.value>0)return"visible"}return"hidden"})}l.select("text").text(function(t){return t.key}).style("visibility",t.showLabel?"visible":"hidden").style("fill",t.color).each(function(){e.styleFont(this)});l.select("line").transition(r).style("stroke",t.color).call(Cr,n,a)}function Rr(){var a=this;var s=this.__execs__.scale;var o=this.isNested();var l=this.grid();var c=this.innerSize();var u=this.__execs__.field;var f=this.isVertical();var t=this.__attrs__.font;var e=function t(e){var i=o?u.region:f?u.x:u.y;var r=o?s.region:f?s.x:s.y;i.axis(e);var n=a.axisDefault(r,e);if(e.orient==="bottom"){n.y(f?s.y.range()[0]:s.x.range()[1])}return n};var i=function t(e){var i=f?u.y:u.x;var r=f?s.y:s.x;i.axis(e);var n=a.axisDefault(r,e);n.grid(l).gridSize(e.orient==="bottom"||e.orient==="top"?c.height:c.width);if(e.orient==="right")n.x((o?s.region:s.x).range()[1]);return n};var r=this.axisX();var n=this.axisY();if(this.isFacet()){this.axisFacet(false)}else{if(r)e(r);if(n)i(n)}this.renderAxis()}function Br(){var t=this.keep();var e=this.scale();var i=this.__execs__.munged;var r=this.isNested();var n=this.stacked();var a=this.aggregated();var s=this.__execs__.field;var o=this.isNestedAndSortByValue();var l=this.viewInterval();var c=this.label();var u=this.diffArrow();var f=this.arrowOnMark();var h=this.colorDomain();var d=this.data();var v=void 0,_=void 0;var p=void 0;if(!(t&&e.x&&e.y)){e.x=X.scaleBand().padding(this.padding());e.y=X.scaleLinear()}if(r){p=s.region.level(0).munged(i).domain();e.region=X.scaleBand().domain(p).padding(this.regionPadding())}if(this.isFacet()){e.color=this.updateColorScale(p,t);return this}var m=1;_=s.x.level(m).munged(i).domain(!o&&this.sortByValue());if(r||!r&&(this.mono()===false||n)){e.color=this.updateColorScale(_,t)}v=sn(s.y,i,m,r,a,n,this.showDiff(),c,f);if(o){_=s.x.domain(this.sortByValue(),null,o);i.forEach(function(e){return e.domain=_.find(function(t){return t.key===e.data.key}).values})}else if(n){if(!r){e.x.domain([s.x.field()])}}else{if(!t&&l){_=this.limitViewInterval(e.x,_)}else if(t&&this.stream()){_=this.limitViewInterval(e.x,_,true)}e.x.domain(_)}this.setCustomDomain("y",v);return this}function jr(){var e=this;var r=this;var n=this.__execs__.scale;var a=this.facet();var t=this.__execs__.canvas;var s=this.mono();var i=this.innerSize();var o=[this.dimensions()[0]];var l=this.isMixed()?[R]:this.measures();var c=void 0,u=void 0;var f=["axisTitles","normalized","padding","orient","font","label","grid","tooltip"].map(function(t){return{key:t,value:e[t]()}});var h=this.axisX();var d=this.axisY();var v=function t(e){var i=on().container(this).data(e).dimensions(o).measures(l).width(c).height(u).legend(false).zeroMargin(true).aggregated(true).parent(r);f.forEach(function(t){i[t.key](t.value)});if(!s)i.color(n.color(e.data.key));if(a.orient==="vertical"){if(h)i.axis({target:"x",orient:"bottom"});if(d)i.axis({target:"y",orient:"left"})}else{if(h)i.axis({target:"x",orient:"bottom"});if(d)i.axis({target:"y",orient:"left"})}i.render()};if(a.orient==="horizontal"){c=n.region.bandwidth();u=i.height}else{c=i.width;u=n.region.bandwidth()}t.selectAll(this.regionName()+".facet").each(v)}function Ir(){var t=this.__execs__.field;if(this.mono()&&(!t.region||this.isFacet())){return}this.renderLegend("x")}function Vr(){var h=this;var t=this.__execs__.canvas;var d=this.isNested.call(this);var v=this.__execs__.scale;var _=this.stacked();var p=this.isVertical();var r=this.color();var n=X.transition().duration(this.transition().duration).delay(this.transition().delay);var m=this.measureName();var a=E(v.y.domain());var s=this.label();var o=this.__execs__.field;var l=this.showDiff();var e=!d&&l;var g=this.isNestedAndSortByValue();var c=this.diffArrow();var u=this.data();var f=this.arrowOnMark();var y=this.downArrowPath();var x=this.upArrowPath();var i=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var u=function t(e){if(i)return r[0];else return v.color(e.data.key)};var f=function t(e){var i=o.x.interval()&&o.x.format()?X.timeFormat(o.x.format()):null;return i?i(e):e};e.each(function(t){var e=void 0,i=void 0,r=void 0,n=void 0;var a=t.value;var s=a>=0;if(_){e=0;i=(p?s:!s)?v.y(t.data.value[m+"-end"]):v.y(t.data.value[m+"-start"]);r=d?v.region.bandwidth():v.x.width;n=Math.abs(v.y(t.data.value[m+"-start"])-v.y(t.data.value[m+"-end"]))}else{if(g){v.x.domain(t.parent.domain)}e=v.x(t.data.key);if(isNaN(e)&&v.x._defaultDomain){e=h.tempPosForOrdinalScale(t.data.key,v.x)}if(c){t.x0=h.tempPosForOrdinalScale(t.data.key,v.x)}i=(p?s:!s)?v.y(a):v.y(0);r=v.x.bandwidth();n=Math.abs(v.y(0)-v.y(a))}var o=p?{x:e,y:i+(s?0:.5),w:r,h:n,upward:s}:{x:i+(s?.5:0),y:e,w:n,h:r,upward:s};o.key=f(t.data.key);o.color=u(t);o.text=Y(a);for(var l in o){if(o.hasOwnProperty(l))t[l]=o[l]}})};var k=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;e.each(function(t){var e=X.select(this);e.style("cursor","pointer").style("fill",function(t){if(X.select(this).classed(Z("diff")))return"none";else return t.color});if(i){e.attr("x",t.x0||t.x).attr("y",t.upward?t.y+t.h:t.y).attr("width",t.w).attr("height",0)}else{e.attr("x",t.upward?t.x:t.x+t.w).attr("y",t.x0||t.y).attr("width",0).attr("height",t.h)}})};var w=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;e.each(function(t){var e=X.select(this);e.style("pointer-events","none").text(t.text);if(i){e.attr("x",(t.x0||t.x)+t.w/2).style("text-anchor","middle");if(_)e.attr("y",t.y+t.h).attr("dy","1em");else if(t.key!==""){if(t.upward)e.attr("y",t.y+t.h).attr("dy","-.25em");else e.attr("y",t.y).attr("dy","1em")}}else{e.attr("y",(t.x0||t.y)+t.h/2).attr("dy",".35em");if(_)e.attr("x",t.x+t.w/2).attr("text-anchor","middle");else if(t.upward)e.attr("x",t.x).attr("dx",".5em");else e.attr("x",t.x+t.w).attr("text-anchor","end").attr("dx","-.1em")}if(t.key===""){e.style("visibility","hidden")}h.styleFont(e)})};var b=function t(e){e.transition(n).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.w}).attr("height",function(t){return t.h}).style("fill",function(t){if(X.select(this).classed(Z("diff")))return"none";if(X.select(this).classed(Z("diff-arrow")))return"none";else return t.color})};var z=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;e.each(function(t){var e=X.select(this);if(i){if(t.key!=="")e.transition(n).attr("y",t.upward?t.y:t.y+t.h)}else{if(_)e.transition(n).attr("x",t.x+t.w/2).attr("text-anchor","middle");else e.transition(n).attr("x",t.upward?t.x+t.w:t.x)}e.text(t.text).style("fill","#fff").style("visibility",s&&(!l||l&&e.classed(Z("diff")))?"visible":"hidden");if(t.key===""){e.style("visibility",e.classed(Z("diff-arrow"))?"visible":"hidden")}})};var A=void 0;var N=t.selectAll(this.regionName());A=N.selectAll(this.nodeName()).data(function(t){var e=t.children;return _?e.slice().reverse():e},function(t){return t.data.key});A.exit().remove();var F=A.enter().append("g").attr("class",this.nodeName(true)).call(i,d?false:this.mono(),this.stream());F.append("rect").attr("class",Z("bar")).call(k,p);F.append("text").attr("class",Z("bar")).call(w,p);if(d&&_){F.append("path").style("fill",function(t){return t.color}).style("visibility","hidden").attr("opacity","0.5")}A.call(i,d?false:this.mono());A=F.merge(A);A.select("rect"+Z("bar",true)).call(b,p);A.select("text"+Z("bar",true)).call(z,p);if(e){var S=void 0;var T=1;var O=T/2;F.append("rect").attr("class",Z("diff")).attr("stroke-dasharray","5, 3").attr("stroke-width",T);F.append("text").attr("class",Z("diff"));A.each(function(t,e,i){if(e>0){t.neighbor=S;var r={value:t.value-S.value,upward:t.upward};if(p){r.x=t.x;r.w=t.w;if(r.value>0){r.y=t.y;r.h=S.y-t.y}else{r.y=S.y;r.h=t.y-S.y}}else{r.y=t.y;r.h=t.h;if(r.value>0){r.x=S.w;r.w=t.w-S.w}else{r.x=t.w;r.w=S.w-t.w}}r.x+=O;r.y+=O;r.h-=T;r.w-=T;r.w=Math.max(T*2,r.w);r.h=Math.max(T*2,r.h);r.text=Y(r.value,true);X.select(this).select("text"+Z("bar",true)).each(function(t){var e=X.select(this).transition(n);if(r.value<0){if(p){e.attr("y",(t.upward?t.y:t.y+t.h)-r.h)}else{e.attr("x",(t.upward?t.x+t.w:t.x)+r.w)}}});X.select(this).select("rect"+Z("bar",true)).transition(n).style("fill",function(t){return t.color=l[(r.value>0?"inc":"dec")+"Fill"]});X.select(this).select("rect"+Z("diff",true)).datum(r).attr("x",p?r.x+O:0).attr("y",p?t.upward?t.y+t.h:t.y:r.y+O).attr("width",p?t.w-T:0).attr("height",p?0:t.h-T).call(b).style("stroke",l[(r.value>0?"inc":"dec")+"Stroke"]);X.select(this).select("text"+Z("diff",true)).datum(r).call(w,p).call(z,p).style("fill",l[(r.value>0?"inc":"dec")+"Fill"]);t.diff=r}else{t.neighbor=X.select(i[e+1]).datum();X.select(this).select("rect"+Z("bar",true)).transition(n).style(l.neuFill);X.select(this).select("rect"+Z("diff",true)).remove()}S=t})}if(c){var P=void 0;var D=1;A.each(function(i,t,e){if(t===c["pos"]){i.neighbor=P;X.select(this).append("image").attr("class",Z("diff-arrow"));X.select(this).append("text").attr("class",Z("diff-arrow"));if(a){i.y=c["value"]>0?v.y(0)-100:v.y(0)}else if(v.y.domain()[0]===0){i.y=v.y(0)-100}else{i.y=v.y(0)}var r=void 0;if(a){r=c["value"]>0?i.y-10:i.y+130}else if(v.y.domain()[0]===0){r=i.y-10}else{r=i.y+130}i.h=100;i.text=Y(c["value"],true);X.select(this).select("text"+Z("bar",true)).each(function(t){var e=X.select(this).transition(n);e.attr("y",i.y)});X.select(this).select("rect"+Z("bar",true)).transition(n);X.select(this).select("image"+Z("diff-arrow",true)).attr("x",i.x).attr("y",i.y).attr("width",p?i.w-D:0).attr("height",p?0:i.h-D).attr("xlink:href",c["value"]<0?y:x).call(b).style("stroke","#40bbfb");X.select(this).select("text"+Z("diff-arrow",true)).datum(i).attr("y",r).call(w,p).call(z,p).style("fill","#40bbfb")}else{}P=i})}if(f){var M=1;var L=M/2;F.append("svg:image").attr("class",Z("markarrow"));F.append("text").attr("class",Z("markarrow"));A.each(function(i,t,e){var r={value:u.filter(function(t){return t.name==i.key})[0][f],upward:true};r.text=Y(r.value,true);r.x=i.x+40;r.w=i.w-80;r.h=60;r.y=50;X.select(this).select("text"+Z("markarrow",true)).each(function(t){var e=X.select(this).transition(n);e.attr("y",i.y-100)});X.select(this).select("rect"+Z("bar",true)).transition(n);X.select(this).select("image"+Z("markarrow",true)).datum(r).attr("x",p?r.x+L:0).attr("y",p?i.upward?i.y+i.h:i.y:r.y+L).attr("width",p?i.w-M:0).attr("height",p?0:i.h-M).attr("xlink:href",r.value<0?y:x).call(b).style("stroke","#40bbfb");X.select(this).select("text"+Z("markarrow",true)).datum(r).call(w,p).call(z,p).style("fill","#40bbfb")})}if(d&&_){var C=X.local();N.each(function(t,e,i){var r=X.select(e<i.length-1?i[e+1]:i[e-1]).datum();var n=r.children;X.select(this).selectAll(h.nodeName()).each(function(e){var t=n.find(function(t){return t.data.key===e.data.key});e.neighbor=t})});N.filter(function(t,e,i){return e<i.length-1}).selectAll(h.nodeName()).select("path").style("fill",function(t){return t.color}).each(function(t){t.diff={value:t.neighbor.value-t.value};var e=t.parent;var i=t.neighbor;var r=i.parent;var n=[];if(p){n.push([t.x+t.w,t.y]);n.push([r.x+i.x-e.x,r.y-e.y+i.y]);n.push([n[1][0],n[1][1]+i.h]);n.push([n[0][0],n[0][1]+t.h])}else{n.push([t.x,t.y+t.h]);n.push([n[0][0]+t.w,n[0][1]]);n.push([r.x+i.x+i.w-e.x,n[0][1]+r.y+i.y-e.y-t.y-t.h]);n.push([n[2][0]-i.w,n[2][1]])}var a=p?[n[0],n[3]]:[n[0],n[1]];a="M"+a[0]+"L"+(p?a[0]:a[1])+"L"+a[1]+"L"+(p?a[1]:a[0])+"z";var s=n.map(function(t,e){return(e===0?"M":"L")+t}).join("")+"z";C.set(this,{source:a,target:s})});A.on("mouseenter.stacked",function(e){A.filter(function(t){return t.data.key!==e.data.key}).selectAll("rect"+Z("bar",true)).transition().style("fill","#b2c0d1");var t=N.selectAll(h.nodeName()).filter(function(t){return t.data.key===e.data.key});if(!s){X.select(this).select("text"+Z("bar",true)).style("visibility","visible");t.select("text"+Z("bar",true)).style("visibility","visible")}t.select("path").style("visibility","visible").attr("d",function(){var t=C.get(this);if(t)return t.source}).interrupt().transition(n).attr("d",function(){var t=C.get(this);if(t)return t.target})}).on("mouseleave.stacked",function(e){A.filter(function(t){return t.data.key!==e.data.key}).selectAll("rect"+Z("bar",true)).transition().style("fill",function(t){return t.color});var t=N.selectAll(h.nodeName()).filter(function(t){return t.data.key===e.data.key});if(!s){X.select(this).select("text"+Z("bar",true)).style("visibility","hidden");t.select("text"+Z("bar",true)).style("visibility","hidden")}t.select("path").interrupt().transition(n).attr("d",function(){var t=C.get(this);if(t)return t.source}).on("end",function(){X.select(this).style("visibility","hidden")})})}}var Gr={interval:null,max:100,order:"natural"};var Hr=function(t){s(i,t);function i(t){r(this,i);var e=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));f(e,Gr);e.setInit(t,["interval","max","order"]);return e}n(i,[{key:"domain",value:function t(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n=this.munged();var a=this.level();var s=this.order();var o=i!=="natural"&&e;var l=0;var c=[];function u(t,e,i){if(i===a){var r=e.filter(function(e){return!t.find(function(t){return t===e})});return t.concat(r)}else{return t.map(function(t){t.values=u(t.values,e,i+1);return t})}}function f(t,e){if(e===a){var i=t.map(r?r:function(t){return{key:t.data.key,value:t.value}});if(o){c=c.concat(i);return h(i,false)}else{return i}}else{if(o){return t.map(function(t){return{key:t.data.key,values:f(t.children,e+1)}})}else{return X.merge(t.map(function(t){return f(t.children,e+1)}))}}}function h(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(e)t=d(t);if((!i||i==="natural")&&s&&s!=="natural")t.sort(z(s,[],true,function(t){return t.key}));if(i&&i!=="natural")t.sort(z(i,[],true,function(t){return t.value}));return t.map(function(t){return t.key})}function d(t){var i=[];t.forEach(function(e){if(!i.find(function(t){return t.key===e.key}))i.push(e)});return i}var t=f(n,l);if(o){var v=d(c).map(function(t){return t.key});l=0;u(t,v,l)}else{t=h(t)}return t}},{key:"isInterval",value:function t(){return this.interval()&&this.format()}},{key:"toObject",value:function t(){var e=a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toObject",this).call(this);e.interval=this.interval();e.max=this.max();e.order=this.order();return e}}]);return i}(M);function Xr(t){return new Hr(t)}h(Hr,Gr);function Yr(t,e){var i=this.__execs__.field;if(t.length<=2&&e.length<=1){if(t.length===2){i.region=Xr(t[0]);i.x=Xr(t[1])}else{i.x=Xr(t[0])}if(e.length===0){this.measure(C)}i.y=I(e[0]);return rn[e.length===0?1:0]}else if(t.length<=1&&e.length>=2){if(t.length===1){i.region=Xr(t[0])}i.x=Xr(this.mixedDimension());i.y=I(R).mixed(true).measures(e);return rn[2]}else throw new x}function Zr(){var i=this;this.condition(Yr);var r=this.__execs__.field;var t=this.isMixed();var e=this.diffArrow();var n=this.data();var a=this.colorDomain();var s=this.color();if(e){var o={};o[r.x.field()]="";n.splice(e["pos"],0,o);this.data(n);if(a){a.splice(e["pos"],0,"");this.colorDomain(a)}else{s.splice(e["pos"],0,"");this.color(s)}}if(this.aggregated()){this.__execs__.munged=[this.data()]}else{if(t){this.__execs__.munged=this.aggregateMixed(this.facet()&&!this.stacked())}else{this.__execs__.munged=this.aggregate(this.facet()&&!this.stacked())}if(!this.isNested())this.__execs__.munged=[this.__execs__.munged[0].parent]}if(this.stacked()){if(!r.region){F(this.__execs__.munged,r.y,this.normalized())}else{var l=void 0;this.__execs__.munged.forEach(function(t,e){if(r.x.order()==="natural"){if(e===0)l=t.children.map(function(t){return t.data.key});else t.children.sort(z("ascending",l,true,function(t){return t.data.key}))}F(t.children,r.y,i.normalized())})}}}function Wr(){if(this.stream()){this.streamPanning(this.__execs__.scale.x)}}function Kr(){var t=this.scale();var e=this.isNested();var i=this.__execs__.field;var r=this.axisX();var n=this.axisY();var a=e?i.region:i.x;var s=this.facet();if(this.isFacet()){var o=this.innerSize();if(s.orient==="horizontal"&&r){r.orient="top";r.showDomain=false;this.thickness(r,t.region,true,true);if(n)n.thickness=0}else if(s.orient==="vertical"&&n){n.orient="right";n.showDomain=false;this.thickness(n,t.region,false,true);if(r)r.thickness=0}if(s.orient==="vertical"){t.region.rangeRound([0,o.height])}else{t.region.rangeRound([0,o.width])}return this}if(this.isVertical()){a.axis(r);this.thickness(n,t.y,false,false);this.thickness(r,e?t.region:t.x,true,true)}else{a.axis(n);this.thickness(n,e?t.region:t.x,false,true);this.thickness(r,t.y,true,false)}var l=this.innerSize();if(this.isVertical()){if(e){t.region.range([0,l.width]);t.x.range([0,t.region.bandwidth()])}else{t.x.range([0,l.width])}t.y.range([l.height,0])}else{if(e){t.region.range([0,l.height]);t.x.range([0,t.region.bandwidth()])}else{t.x.range([0,l.height])}t.y.range([0,l.width])}return this}function Jr(){var a=this.aggregated();var s=this.isNested.call(this);var o=this.__execs__.scale;var l=this.stacked();var c=this.facet();var u=this.isVertical();var t=this.isFacet();var e=function t(e){if(a)return;var i=s?[o.region(e.data.key),0]:[0,0];if(c&&!l&&c.orient==="vertical"){i.reverse()}else if(!u&&c.orient!=="horizontal"){i.reverse()}var r=i[0];var n=i[1];e.x=r;e.y=n};this.renderRegion(e,function(t){return t},t)}function qr(){if(!this.tooltip()||this.isFacet())return;var n=this.parent();var a=this.isMixed();var s=this.__execs__.field;var o=this.stacked()&&this.isNested()&&!this.isFacet();var l=this.isVertical();var c=this.showDiff()&&!this.isNested();var t=function t(e,i){return{name:"key",value:i}};var e=function t(e,i){var r=void 0;if(a){r=e.key}else if(n&&n.isMixed()){r=e.key}else{r=s.y.field()}return{name:r,value:i}};var i=function t(e){var i=e.neighbor;var r=[{name:(c?e:e.parent).data.key,value:e.text},{name:(c?i:i.parent).data.key,value:i.text}];if(c)r.reverse();var n=e.diff?e.diff.value:i.diff.value;r.push({name:"(+/-)",value:n});return r};var r=function t(e){var i=0,r=0;if(o){i=Math.max(-e.x+e.neighbor.x+e.neighbor.w,e.w);if(l){if(e.neighbor.parent.x>e.parent.x)i+=Math.abs(e.neighbor.parent.x-e.parent.x)-e.w}else{var n=e.neighbor.parent.y-e.parent.y;if(n<0){i=e.w}else{r+=e.h+(n-e.h)/2}}}else{i+=e.w}return{x:i,y:r}};var u={key:t,offset:r};if(o||c){u.value=i;u.showDiff=true}else{u.value=e}this.renderTooltip(u)}function Ur(t,e,i){t.attr("transform","translate("+[e.width+i[0],-20+i[1]]+")")}function Qr(){var t=this.unit();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".unit-text").empty()){e.append("text").attr("class","unit-text")}var n=e.select(".unit-text");n.text(t?t["text"]?t["text"]:t:"").style("font-family","Noto Sans KR").style("font-size","22px").style("font-weight","600").style("fill","#C6CBCE").attr("text-anchor","end").call(Ur,r,t?t["pos"]?t["pos"]:[0,0]:[0,0])}function $r(t,e,i){t.attr("transform","translate("+[i[0]-85,i[1]-20]+")")}function tn(){var t=this.title();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".title_text").empty()){e.append("text").attr("class","title_text")}var n=e.select(".title_text");n.text(t?t["text"]?t["text"]:t:"").style("font-family","Noto Sans KR").style("font-size","40px").style("font-weight","bold").style("fill","#FFFFFF").attr("text-anchor","start").call($r,r,t?t["pos"]?t["pos"]:[0,0]:[0,0])}var en=["vertical","horizontal"];var rn=["normal","count","mixed"];var nn={annotation:false,mono:true,orient:en[0],padding:.05,showDiff:false,regionPadding:.1};var an=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(nn);t.process("munge",Zr,{isPre:true}).process("domain",Br,{isPre:true}).process("range",Kr,{isPre:true}).process("unit",Qr).process("title",tn).process("axis",Rr).process("region",Jr).process("facet",jr,{allow:function t(){return this.isFacet()}}).process("mark",Vr,{allow:function t(){return!this.isFacet()}}).process("legend",Ir).process("tooltip",qr).process("padding",Wr).process("annotation",Er);return t}n(e,[{key:"measureName",value:function t(){var e=this.measures();var i=void 0;if(this.condition()===rn[2])i=R.field;else if(this.aggregated()&&e[0].field===R.field)i=e[0].field;else i=e[0].field+"-"+e[0].op;return i}},{key:"muteToLegend",value:function t(e){this.muteLegend(this.isFacet()?e.parent.data.key:e.data.key)}},{key:"muteFromLegend",value:function t(e){if(this.isFacet())this.muteRegions(e.key);else this.muteNodes(e.key)}},{key:"demuteToLegend",value:function t(e){this.demuteLegend(this.isFacet()?e.parent.data.key:e.data.key)}},{key:"demuteFromLegend",value:function t(e){if(this.isFacet())this.demuteRegions(e.key);this.demuteNodes(e.key)}},{key:"isCount",value:function t(){return this.condition()===rn[1]}},{key:"isFacet",value:function t(){return this.facet()&&this.isNested()&&!this.stacked()}},{key:"isMixed",value:function t(){return this.condition()===rn[2]}},{key:"isNested",value:function t(){var e=this.dimensions();var i=this.condition();return e.length===2||i==rn[2]&&e.length===1}},{key:"isVertical",value:function t(){return this.orient()===en[0]}},{key:"isNestedAndSortByValue",value:function t(){return this.isNested()&&this.sortByValue()!=="natural"}}]);return e}(_(pr).with(wr,gr,zr,Mr));an.prototype.annotation=e("annotation",{showLabel:true,color:"#477cd2"});an.prototype.showDiff=e("showDiff",{neuFill:"#c0ccda",incStroke:"#477cd2",incFill:"#40bbfb",decStroke:"#f06292",decFill:"#f06292"});an.prototype.mono=c("mono");an.prototype.orient=c("orient");function sn(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;var s=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;var o=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;var l=arguments.length>8&&arguments[8]!==undefined?arguments[8]:false;var c=t.level(i).munged(e).aggregated(n).domain(0,a);if(c[0]>0)c[0]=0;else if(c[1]<0)c[1]=0;if(s&&!r){if(c[0]===0)c[1]*=1.25;else if(c[1]===0)c[0]*=1.25}if(o){if(c[0]===0)c[1]*=1.1;else if(c[1]===0)c[0]*=1.1;else{c[0]*=1.1;c[1]*=1.1}}if(l){if(c[0]===0)c[1]*=1.25;else if(c[1]===0)c[0]*=1.25;else{c[1]*=1.5}}return c}an.prototype.unit=c("unit");an.prototype.title=c("title");an.prototype.diffArrow=c("diffArrow");an.prototype.arrowOnMark=c("arrowOnMark");var on=m(an);function ln(t){if(!arguments.length)return this.__attrs__.brushGen;this.__attrs__.brushGen=t;var e=this.__execs__.brushDispatch;t.on("start.brushable",function(){e.apply("brushStart",this,arguments)}).on("brush.brushable",function(){e.apply("brushed",this,arguments)}).on("end.brushable",function(){e.apply("brushEnd",this,arguments)});return this}function cn(t,e){var i=this.brushGen();t.call(i.move,e);return this}var un={brush:false,brushGen:null};var fn=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(un);t.__execs__.brush=null;t.__execs__.brushDispatch=X.dispatch("brushStart","brushed","brushEnd");t.rebindOnMethod(t.__execs__.brushDispatch);return t}return e}(e);i.prototype.brush=c("brush");i.prototype.brushGen=ln;i.prototype.brushMove=cn;return i};var hn={fitLine:false};var dn=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(hn);return t}return e}(e);i.prototype.fitLine=c("fitLine");return i};function vn(t){if(!arguments.length||t===false)return this.__attrs__.seriesName;else if(typeof t==="boolean"&&t){return this.__attrs__.seriesName.split(".").join(" ").trim()}else if(typeof t==="string"){this.__attrs__.seriesName=t}return this}var _n=["linear","stepped","curved"];var pn={curve:_n[0],point:false,pointRatio:3,seriesName:Z("mark series",true)};var mn=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(pn);return t}return e}(e);i.prototype.seriesName=vn;i.prototype.curve=c("curve");i.prototype.point=c("point");i.prototype.pointRatio=c("pointRatio");return i};function gn(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(t){return X.max(this.__execs__.munged,function(t){return t.children.length})}else{return this.__execs__.munged.length}}function yn(e){var t=["normal","brush"];if(!arguments.length)return this.__attrs__.zoom;if(typeof e==="boolean"){if(e)this.__attrs__.zoom="normal";else this.__attrs__.zoom=false}else if(typeof e==="string"){if(t.findIndex(function(t){return t.localeCompare(e)===0})>=0){this.__attrs__.zoom=e}}return this}function xn(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2;var r=this.pointNum(t);var n=this.__execs__.scale;var a=n.x.range();var s=Math.abs(a[1]-a[0]);if(e){var o=n.y.range();var l=Math.abs(o[1]-o[0]);if(s>l)s=l}var c=r*r/s;return[1,Math.ceil(c*i)]}function kn(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var t=this.zoomGen();var i=this;var r=this.__execs__.field;var a=this.__execs__.axis;var s=a&&a.x?a.x[r.x.field()]:null;var o=this.__execs__.scale;var l=o.x;var c=n&&a&&a.y?a.y[r.y.field()]:null;var u=n?o.y:null;var f=function t(e){var i=e.rescaleX(l);o.x=i;if(s){s.scale(i);s.render(null,true)}if(n){var r=e.rescaleX(u);o.y=r;if(c){c.scale(r);c.render(null,true)}}};t.on("zoom.zoomable.zoomed",function(){var t=X.event.transform;if(!t)return;f(t);if(i.__execs__.tooltip)i.__execs__.tooltip.hide();e()});return this}function wn(t){if(!arguments.length)return this.__attrs__.zoomGen;this.__attrs__.zoomGen=t;var e=this;var i=e.__execs__.zoomDispatch;t.on("zoom.zoomable",function(){i.apply("zoom",this,arguments)});return this}function bn(t,e){t.call(this.zoomGen().transform,e);return this}var zn={zoom:false,zoomGen:null};var An=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(zn);t.__execs__.zoom=null;t.__execs__.zoomDispatch=X.dispatch("zoom");t.rebindOnMethod(t.__execs__.zoomDispatch);return t}return e}(e);i.prototype.pointNum=gn;i.prototype.zoom=yn;i.prototype.zoomed=kn;i.prototype.zoomExtent=xn;i.prototype.zoomGen=wn;i.prototype.zoomTransform=bn;i.prototype.isBrushZoom=Nn;h(i,zn);return i};function Nn(){return this.__attrs__.zoom&&this.__attrs__.zoom==="brush"}var Fn={shape:null};var Sn=function t(e){var i=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(Fn);return t}return e}(e);i.prototype.shape=c("shape");return i};function Tn(){if(!this.brush())return;var t=this.__execs__.canvas;var e=this.innerSize();var i=X.brushX().extent([[0,0],[e.width,e.height]]);var r=t.selectAll(".brush.x").data([e]);r.exit().remove();r.enter().append("g").attr("class","brush x").merge(r).attr("transform","translate("+[0,0]+")").call(i);this.brushGen(i)}function On(){var t=this.__execs__.field;if(!t.region){return}this.renderLegend()}function Pn(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:.75;this.noAxisOffset(true);this.renderCanvas();var n=this;var a=this.innerSize();var r=Math.round(a.height*t);var i=a.height-r;var s=["axis","axisTitles","color","curve","multiTooltip","normalized","padding","point","pointRatio","regionPadding","shape","size","stacked","grid","font","label","tooltip"].map(function(t){return{key:t,value:e[t]()}});var o=[];var l=function t(e,i){e.x=0;e.y=i===0?0:r};var c=this.renderRegion(l,[{h:r},{h:i}],true);c.each(function(t,e){var i=ka().container(this).data(n.data()).dimensions(n.dimensions()).measures(n.measures()).width(a.width).height(t.h).legend(false).zeroMargin(true).parent(n);s.forEach(function(t){return i[t.key](t.value)});if(e==0){var r=i.axis().find(function(t){return t.target==="x"});if(r)r.showTitle=false;i.brush(false).zoom("normal")}else{i.multiTooltip(false).tooltip(false).brush(true).point(false)}i.render();o.push(i)});if(this.isNested()){var u=this.__execs__.field.region.munged(this.__execs__.munged).level(0).domain();this.scale().color=X.scaleOrdinal().domain(u).range(this.color());On.call(this)}var f=o[1].__execs__.scale.x;var h=o[1].__execs__.canvas.select(".brush.x");var d=o[0].__execs__.scale.x;var v=this.__execs__.canvas;o[0].on("zoom.line",function(){if(X.event.sourceEvent&&(X.event.sourceEvent.type==="zoom"||X.event.sourceEvent.type==="end"||X.event.sourceEvent.type==="brush"))return;var t=X.event.transform.rescaleX(f).domain();o[1].brushMove(h,t.map(f))});o[1].on("brushed.line brushEnd.line",function(){if(X.event.sourceEvent&&X.event.sourceEvent.type==="brush")return;var t=X.event.selection||f.range();var e=t.map(f.invert);t=e.map(d);o[0].zoomTransform(v,X.zoomIdentity.scale((d.range()[1]-d.range()[0])/(t[1]-t[0])).translate(-t[0],0))})}function Dn(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var o=this;var e=this.__execs__.canvas;var r=this.__execs__.field;var l=this.isNested.call(this);var c=this.__execs__.scale;var s=this.isStacked();var u=this.color();var i=this.label();var f=this.isIndividualScale();var h=this.size();var n=this.point();var a=this.pointRatio();var d=t?X.transition().duration(0).delay(0):X.transition().duration(this.transition().duration).delay(this.transition().delay);var v=this.shape()===pa[1];var _=v&&this.areaGradient();var p=this.measureName();var m=this.curve()===_n[0]?X.curveLinear:this.curve()===_n[1]?X.curveStep:X.curveCatmullRom;var g=this.scaleBandMode();var y=this.multiTooltip();var x=this.stream();var k=this.diffWithArrow();var w=this.downArrowPath();var b=this.upArrowPath();var z=this.font();var A=function t(e){return r.x.interval()?new Date(e.data.key):e.data.key};var N=function t(e){return c.x(A(e))+(g?c.x.bandwidth()/2:0)};var F=function t(e){return function(t){return s?e(t.data.value[p+"-end"]):e(t.data.value[p])}};var S=X.line().x(N).y(X.max(c.y.range())).curve(m);var T=function t(e){return X.line().x(N).y(F(e)).curve(m)};var O=X.area().x(N).y(X.max(c.y.range())).curve(m);var P=function t(e){return X.area().x(N).y0(function(t){return s?c.y(t.data.value[p+"-start"]):X.max(c.y.range())}).y1(F(e)).curve(m)};var D=function t(e){var a=function t(e){var i=r.x.isInterval()?X.timeFormat(r.x.format()):null;return i?i(e):e};e.each(function(t,e,i){t.value=s?t.data.value[p+"-end"]:t.data.value[p];t.x=N(t);if(isNaN(t.x)&&c.x._defaultDomain){t.x=o.tempPosForOrdinalScale(A(t),c.x)}if(x){var r=A(t);if(c.x.invert){var n=o.distDomain(c.x);if(r>c.x._lastDomain[c.x._lastDomain.length-1]){t.x0=t.x+n}}else{t.x0=o.tempPosForOrdinalScale(A(t),c.x)}}t.y=F(f?t.parent.scale:c.y)(t);t.anchor=e===0?"start":e===i.length-1?"end":"middle";t.text=Y(t.value);t.color=t.parent.color;t.key=a(t.data.key)})};var M=function t(e){e.each(function(t,e,i){var r=true;if(e<i.length-1&&i[e+1]){var n=i[e+1];r=n.y<=t.y}t.upward=r})};var L=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(i){e.each(function(t){var e=t.children;X.select(this).attr("d",O(e)).attr("fill-opacity",.4).style("stroke","none")})}else{e.each(function(t){var e=t.children;X.select(this).attr("d",S(e)).style("fill","none");var i=e.map(function(t){return t.value});t.diff=i[i.length-1]-i[i.length-2];t.y=F(c.y)(t.children[t.children.length-1]);t.x=N(t.children[t.children.length-1])})}};var C=function t(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=function t(e){return l?c.color(e.data.key):u[0]};var a=n&&o.distDomain(c.x);e.each(function(t){var e=t.children;var i=X.select(this);if(n){i.attr("d",(r?P:T)(f?t.scale:c.y)(e)).attr("transform","translate("+a+",0)").transition(d).attr("transform","translate(0,0)")}else{i.transition(d).attr("d",(r?P:T)(f?t.scale:c.y)(e))}});if(r){e.attr("fill",i).attr("stroke","none")}else{if(_){var s=function t(e){return"url(#areaGradient-"+e.data.key+")"};e.attr("stroke","none").attr("fill",s)}else if(r){e.attr("fill",i)}else{e.attr("stroke",i).attr("stroke-width",h.range[0]+"px")}}};var E=function t(e){e.attr("r",(h.range[0]-h.range[0]/4)*a).attr("stroke-width",h.range[0]/4*a).attr("opacity",n?1:0).style("cursor","pointer").attr("cx",function(t){return t.x0||t.x}).attr("cy",function(t){return x?t.y:X.max(c.y.range())})};var R=function t(e){e.transition(d).attr("r",(h.range[0]-h.range[0]/4)*a).attr("stroke-width",h.range[0]/4*a).attr("opacity",n?1:0).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})};var B=function t(e){e.each(function(t){var e=X.select(this);e.attr("x",function(t){return t.x0||t.x}).attr("y",function(t){return x?t.y:X.max(c.y.range())}).attr("stroke","none").style("fiil","#ffffff").style("visibility",i?"visible":"hidden").text(t.text);o.styleFont(e)})};var j=function t(e){e.each(function(t){var e=X.select(this);if(t.anchor=="end"){t.anchor="start";t.x+=15;t.text+="  "+t.parent.data.key}else if(t.anchor=="start"){t.anchor="end";t.x-=15}e.attr("text-anchor",t.anchor).style("pointer-events",y?"none":"all").transition(d).attr("y",t.y+z["font-size"]*.75/2).attr("x",t.x).attr("dy",t.upward?".71em":0).style("visibility",i?"visible":"hidden").text(t.text);o.styleFont(e)})};var I=function t(e){var i=e.select(o.seriesName());if(i.empty()){i=e.append("g").attr("class",o.seriesName(true))}var r=function t(e,i){var r=e.selectAll("path"+Z(i?"area":"line",true)).data(function(t){return[t]},function(t,e){return t.data?t.data.key:e});r.exit().remove();r.enter().append("path").attr("class",Z(i?"area":"line")).call(L,i).merge(r).call(C,i,x).style("pointer-events","none")};if(v){i.call(r,true)}else{i.selectAll("path"+Z("area",true)).remove()}i.call(r,false)};var V=function t(e){e.attr("fill",function(t){return t.color}).attr("stroke",function(t){return t.color});var i=e.selectAll(o.nodeName()).data(function(t){return t.children},function(t){return t.data.key});i.exit().remove();var r=i.enter().append("g").attr("class",o.nodeName(true)).call(D);r.append("circle").call(E);r.append("text").call(B);i.call(D);i=r.merge(i).call(M);i.select("circle").call(R);i.select("text").call(j)};var G=function t(e){var i=e.select(o.seriesName(true)+"arrow");if(i.empty()){i=e.append("g").attr("class",o.seriesName(true)+"arrow")}i.append("svg:image").attr("class",Z("markarrow"));i.append("text").attr("class",Z("markarrow"));var r=e.select(o.seriesName());var n={};r.each(function(t,e,i){n={value:t.diff,x:t.x+125,y:t.y-10,h:20,w:20,text:Y(t.diff,true)}});i.select("image"+Z("markarrow",true)).datum(n).attr("x",n.x).attr("y",n.y).attr("height",n.h).attr("width",n.w).attr("xlink:href",n.value<0?w:b);i.select("text"+Z("markarrow",true)).datum(n).attr("x",n.x+25).attr("y",n.y+15).attr("height",n.h).attr("width",n.w).text(n.text)};var H=e.selectAll(this.regionName());H.each(function(){X.select(this).each(function(t){t.children.sort(function(t,e){return N(t)-N(e)})}).call(I).call(V)});if(k){H.each(function(){X.select(this).each(function(t){t.children.sort(function(t,e){return N(t)-N(e)})}).call(G)})}}function Mn(){var e=this;var t=function t(e,i){var r=this.__execs__.field;if(e.length<=2&&i.length<2){if(e[1])r.region=Xr(e[1]);r.x=Xr(e[0]);if(i.length===0)this.measure(C);r.y=I(i[0]);if(i.length===0)return ma[1];else if(i.length===1)return ma[0]}else if(e.length===1&&i.length>=2){r.region=Xr(this.mixedDimension());r.x=Xr(e[0]);r.y=I(R).mixed(true).measures(i);return ma[2]}else throw new x};this.condition(t);var i=this.__execs__.field;var r=this.isMixed();if(this.aggregated()){this.__execs__.munged=[this.data()]}else if(r){this.__execs__.munged=this.aggregateMixed(true)}else{this.__execs__.munged=this.aggregate(true);if(!this.isNested()){this.__execs__.munged=[this.__execs__.munged[0].parent]}}if(this.isStacked()){var n=this.__execs__.munged;var a=n[0].children.map(function(t){return t.data.key});n.forEach(function(t,e){if(e>0){t.children.sort(z("ascending",a,true,function(t){return t.data.key}))}});var s=n.map(function(t){return t.children});s=X.zip.apply(null,s);s.forEach(function(t){F(t,i.y,e.normalized())})}}function Ln(){if(this.stream()){this.streamPanning(this.__execs__.scale.x)}}function Cn(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var r=e.field();var n=t.children.map(function(t){return t.data.value[r]});n=X.extent(n);if(i<=0)return n;var a=Math.abs(n[0]-n[1]);a*=i*.5;return[n[0]-a,n[1]+a]}function En(){var r=this;var t=this.keep();var e=this.scale();var i=this.__execs__.munged;var n=this.isNested();var a=this.isStacked();var s=this.aggregated();var o=this.__execs__.field;var l=1;var c=this.isMixed();var u=this.isIndividualScale();var f=this.viewInterval();var h=void 0,d=void 0;var v=void 0;e.y=X.scaleLinear();if(n){v=o.region.level(0).munged(i).domain();e.color=this.updateColorScale(v,t)}if(this.isFacet()){e.region=X.scaleBand().domain(v).padding(this.regionPadding());return}d=o.x.munged(i).level(l).domain();h=xa(o.y,i,l,s,a);var _=true;for(var p=0;p<d.length;p++){var m=d[p];if(isNaN(m)){_=false;break}else if(typeof m==="string"){d[p]=+m}}if(this.scaleBandMode()){if(!t)e.x=X.scaleBand().padding(this.padding())}else if(o.x.interval()||_){if(o.x.order()==="natural"){if(d[0]instanceof Date)d=X.extent(d);else d=X.extent(d.map(function(t){return+t}))}else{d=[d[0],d[d.length-1]]}if(!t)e.x=S(d,null,o.x)}else{if(!t)e.x=X.scalePoint().padding(this.padding())}if(!t&&f){d=this.limitViewInterval(e.x,d)}else if(t&&this.stream()){d=this.limitViewInterval(e.x,d,true)}e.x.domain(o.x.customDomain()?o.x.customDomain():d);this.setCustomDomain("y",h);if(c&&u){i.forEach(function(e){var t=Cn(e,o.y,r.padding());e.scale=X.scaleLinear().domain(t).nice();e.scale._defaultDomain=t;if(r.isMixed()){var i=r.measures().find(function(t){return t.field===e.data.key});if(i&&i.customDomain){e.scale._defaultDomain=t;e.scale.domain(i.customDomain)}}})}return this}function Rn(){var t=this.scale();var e=this.__execs__.munged;var i=this.isIndividualScale();var r=this.facet();var n=this.isMixed();var a=this.axisX();var s=this.axisY();var o=this.diffWithArrow();if(this.isFacet()){if(r.orient==="horizontal"&&a){a.orient="top";a.showDomain=false;this.thickness(a,t.region,true,true);if(s)s.thickness=0}else if(r.orient==="vertical"&&s){s.orient="right";s.showDomain=false;this.thickness(s,t.region,false,true);if(a)a.thickness=0}var l=this.innerSize();if(r.orient==="vertical"){t.region.rangeRound([0,l.height])}else{t.region.rangeRound([0,l.width])}return}if(n&&i&&s){s.orient="left";this.thickness(s,e[0].scale,false,false);var c=Object.assign({},s);c.orient="right";this.axis(c);this.thickness(c,e[e.length-1].scale,false,false)}else if(s){var u=this.axis().find(function(t){return t.target==="y"&&t.orient!==s.orient});if(u)this.axis(u,false);this.thickness(s,t.y,false,false)}this.thickness(a,t.x,true,t.x.invert?false:true);var f=this.innerSize();t.x.range([0,f.width]);if(t.x.invert&&!this.scaleBandMode()){var h=t.x.domain();var d=this.padding();d=f.height*d/2;var v=f.width-d;if(h[0]===h[1]||h[1]-h[0]===0){var _=(d+v)/2;t.x.range([_,_])}else{t.x.range([d,v])}}if(o){var p=0;var m=f.width-p;t.x.range([p+100,m-200])}t.y.range([f.height,0]);if(i){e.forEach(function(t){t.scale.range([f.height,0])})}return this}function Bn(){var a=this;var i=this.__execs__.munged;var s=this.__execs__.scale;var o=this.grid();var t=this.isIndividualScale();var l=this.innerSize();var c=this.__execs__.field;var e=function t(e){c.x.axis(e);var i=a.axisDefault(s.x,e);if(s.x.invert)i.grid(o).gridSize(l.height);if(e.orient==="bottom")i.y(s.y.range()[0]);return i};var r=function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:s.y;var r=arguments[2];if(!r){c.y.axis(e)}else{e.field=r}var n=a.axisDefault(i,e);n.grid(o).gridSize(l.width);if(e.orient==="right")n.x(s.x.range()[1]);return n};var n=this.axisX();var u=this.axisY();if(this.isFacet()){this.axisFacet()}else{if(n){e(n)}if(u){if(t){var f=this.axis().filter(function(t){return t.target==="y"});if(i.length<=2){f.forEach(function(t,e){return r(t,i[e].scale,i[e].data.key)})}}else{r(u)}}}this.renderAxis()}var jn="#aaa";function In(){var t=this.__execs__.canvas;var e=t.select(".mean-line-g");if(!(typeof this.meanLine()==="number")&&(!this.meanLine()||this.isFacet())){e.remove();return}var i=this.meanLine();var r=[];var n=this.__execs__.scale;var a=X.transition().duration(this.transition().duration).delay(this.transition().delay);if(typeof i==="number"){var s=n.y.domain();if(i>=s[0]&&i<=s[1]){r.push({value:i,y:n.y(i)})}}else{this.regions().filter(function(t){if(typeof i==="string"){return t.data.key===i}else{return true}}).each(function(t){var e={value:X.mean(t.children,function(t){return t.value})};e.y=n.y(e.value);r.push(e)})}if(e.empty){e=t.append("g").attr("class","mean-line-g")}var o=e.selectAll(".mean-line").data(r);o.exit().remove();var l=o.enter().append("g").attr("class","mean-line").attr("transform","translate("+[0,n.y.range()[0]]+")").style("pointer-events","none");l.append("line").attr("stroke",jn).attr("shape-rendering","crispEdges").attr("stroke-width","2px").attr("x2",n.x.range()[1]);o=l.merge(o).transition(a).attr("transform",function(t){return"translate("+[0,t.y]+")"});o.select("line").transition(a).attr("x2",n.x.range()[1])}function Vn(){var a=this.aggregated();var s=this.__execs__.canvas;var o=this.isNested();var l=this.__execs__.scale;var c=this.stacked();var u=this.facet();var t=this.isFacet();var e=this.shape()===pa[1];var f=e&&this.areaGradient();var h=this.color();var i=function t(e){if(a)return;var i=void 0;if(!o){i=[0,0]}else if(u&&!c){i=[l.region(e.data.key),0];if(u.orient==="vertical"){i.reverse()}}else{i=[0,0]}e.x=i[0];e.y=i[1];e.color=o?l.color(e.data.key):h[0];if(f){var r=s.append("defs");var n=r.append("linearGradient").attr("id","areaGradient-"+e.data.key).attr("x1","30%").attr("x2","50%").attr("y1","80%").attr("y2","0%");n.append("stop").attr("offset","0%").attr("stop-color",e.color).attr("stop-opacity",0);n.append("stop").attr("offset","100%").attr("stop-color",e.color).attr("stop-opacity",1)}};if(!t&&this.multiTooltip()){var r=s.select(".multi-tooltip-g");if(r.empty())r=s.append("g").attr("class","multi-tooltip-g")}this.renderRegion(i,function(t){var e=c?t.slice().reverse():t;return e},t)}function Gn(){var e=this;var r=this;var n=this.__execs__.scale;var t=this.facet();var i=this.__execs__.canvas;var a=this.innerSize();var s=[this.dimensions()[0]];var o=this.isMixed()?[R]:this.measures();var l=void 0,c=void 0;var u=["axisTitles","curve","meanLine","multiTooltip","normalized","padding","point","pointRatio","regionPadding","shape","size","grid","font","label"].map(function(t){return{key:t,value:e[t]()}});var f=this.axisX();var h=this.axisY();var d=[];var v=function t(e){var i=ka().container(this).data(e).dimensions(s).measures(o).width(l).height(c).legend(false).tooltip(false).parent(r).zeroMargin(true).aggregated(true).color(n.color(e.data.key));u.forEach(function(t){return i[t.key](t.value)});if(h)i.axis({target:"y",orient:"left"});if(f)i.axis({target:"x",orient:"bottom"});i.render();d.push(i)};if(t.orient==="horizontal"){l=n.region.bandwidth();c=a.height}else{l=a.width;c=n.region.bandwidth()}i.selectAll(".facet").each(v);d.forEach(function(i){i.on("selectStart.facet selectMove.facet selectEnd.facet",function(e){d.forEach(function(t){if(t!==i){t.showMultiTooltip(e)}})})})}var Hn="#c0ccda";function Xn(){var t=this.__execs__.canvas;var e=this.__execs__.scale;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.fitLine();var n=t.selectAll(Z("fit-line-g",true));if(!r||!e.x.invert){if(!n.empty())t.select(Z("fit-line-g",true)).remove();return}var a=this.leastSquare(r);var s=e.x.domain();var o=a.map(function(e){return s.map(function(t){return e.slope*t+e.intercept})});if(n.empty()){n=t.append("g").attr("class",Z("fit-line-g")).attr("clip-path","url(#"+t.selectAll(Z("canvas-g-clip-path",true)).attr("id"))}n.datum(o);var l=n.selectAll(Z("fit-line",true)).data(function(t){return t});l.exit().remove();var c=l.enter().append("line").attr("class",Z("fit-line")).style("fill","none").style("stroke",Hn).style("stroke-width",1).attr("x1",e.x(s[0])).attr("x2",e.x(s[1])).attr("y1",function(t){return(t.scale?t.scale:e.y).range()[0]}).attr("y2",function(t){return(t.scale?t.scale:e.y).range()[0]});l=c.merge(l);l.transition(i).attr("x1",e.x.range()[0],e.x(s[0])).attr("x2",e.x(s[1])).attr("y1",function(t){return(t.scale?t.scale:e.y)(t[0])}).attr("y2",function(t){return(t.scale?t.scale:e.y)(t[1])})}var Yn={"font-family":"sans-serif","font-size":12,"font-weight":"normal","font-style":"normal"};var Zn="#fff";var Wn="#b0bec5";var Kn={anchor:{x:"left",y:"top"},color:Wn,dx:0,dy:0,height:null,font:Yn,nodeName:Z("mark node",true),tooltip:null,target:null,keyFormat:null,valueFormat:null,width:null,sortByValue:{type:"natural"},x:0,y:0};var Jn=function t(){r(this,t);this.__attrs__=JSON.parse(JSON.stringify(Kn));this.__execs__={tooltip:null,domain:null,dispatch:X.dispatch("start","move","end")};this.valueFormat(Y);i(this,this.__execs__.dispatch)};function qn(){return new Jn}function Un(l){var c=this;var u=this.__execs__.domain;var f=this.__execs__.dispatch;var h=X.bisector(function(t){return t.x}).right;var d=null;var t=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var i=l.node().getBoundingClientRect().left;var r=X.event.x-i;var n=h(u,r);if(n>0&&n<u.length){var a=Math.abs(r-u[n-1].x);var s=Math.abs(u[n].x-r);if(a<s)n=n-1}n=Math.max(0,Math.min(u.length-1,n));var o=u[n];if(!d||o.x!==d.x||e){ea.call(c,l,o);f.call(e?"start":"move",this,o);d=o}};l.on("mouseenter.multi-tooltip",function(){t(true)}).on("mousemove.multi-tooltip",function(){t(false)}).on("mouseleave.multi-tooltip",function(){$n.call(c,l);f.call("end",this);d=null})}function Qn(){var t=this.target();var e=t.__execs__.canvas.selectAll(this.nodeName());var i=[];e.each(function(e){var t=i.find(function(t){return t.x===e.x});if(t){t.points.push(this)}else{i.push({x:e.x,points:[this],value:e.key})}});this.__execs__.domain=i.sort(function(t,e){return t.x-e.x})}function $n(t){var e=X.transition().duration(180);t.select(Z("baseline",true)).transition(e).attr("opacity",0);var i=this.target();var r=i.nodes().filter(function(){return X.select(this).classed(Z("show"))}).classed(Z("show"),false).selectAll("circle");if(!i.point())r.attr("opacity",0);else r.style("fill",Zn);if(this.tooltip())this.tooltip().hide()}function ta(t){var e=this.target().innerSize();t.style("fill","none");var i=t.select(Z("overlay",true));if(i.empty()){i=t.append("rect").attr("class",Z("overlay")).style("cursor","crosshair");t.append("line").attr("class",Z("baseline")).attr("opacity",0).attr("shape-rendering","crispEdges").attr("pointer-events","none")}t.select(Z("baseline",true)).attr("y1",0).attr("y2",this.height()?this.height():e.height).attr("stroke",Wn);i.attr("width",this.width()?this.width():e.width).attr("height",this.height()?this.height():e.height);Qn.call(this);Un.call(this,t);this.__execs__.tooltip=t}function ea(t,i){var e=X.transition().duration(140);var r=this.target();var n=[];if(!r.point()){r.__execs__.canvas.selectAll(this.nodeName()).selectAll("circle").transition(e).attr("opacity",0)}else{r.__execs__.canvas.selectAll(this.nodeName()).selectAll("circle").transition(e).style("fill",Zn)}var a=X.selectAll(i.points).each(function(t){var e=t.x;if(e===i.x){n.push({key:t.key,x:t.x,y:t.y,text:t.text})}});a.classed(Z("show"),true).selectAll("circle").transition(e).attr("opacity",1).style("fill",function(t){return t.color});var s=t.select(Z("baseline",true));s.transition(e).attr("opacity",1).attr("x1",i.x+.5).attr("x2",i.x+.5);var o=this.tooltip();var l=void 0,c=[];var u=[];X.selectAll(i.points).each(function(t){var e=o.__execs__.mark.get(this);l=e.x;c.push(e.y);u.push(t)});aa(u,this.sortByValue());u=u.map(function(t){return{name:t.parent.data.key||t.data.key,value:t.text}});if(this.keyFormat()){var f=this.keyFormat();u.forEach(function(t){if(t.name instanceof Date||typeof t.name==="number")t.name=f(t.name)})}c=X.mean(c);c=Math.round(c);if(l&&c){var h=i.value;if(this.keyFormat()&&(h instanceof Date||typeof h==="number"))h=this.keyFormat()(h);o.x(l).y(c).key({name:"key",value:h}).value(u).show()}else{o.hide()}}function ia(){$n.call(this,this.__execs__.tooltip);X.dispatch.call("end",this)}function ra(t){t=X.select(t);ta.call(this,t)}function na(e){var t=this.__execs__.tooltip;var i=this.__execs__.domain;if(e!==undefined&&e!==null){var r=i.find(function(t){return t.value==e.value});ea.call(this,t,{x:r?r.x:e.x,points:r?r.points:null,value:r?r.value:null})}else{$n.call(this,t)}}function aa(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"natural";var i=["natural","ascending","descending"];if(i.find(function(t){return t===e})){if(t.length>0){if(e===i[1]){t.sort(function(t,e){return X.ascending(t.value,e.value)})}else if(e===i[2]){t.sort(function(t,e){return X.descending(t.value,e.value)})}}}}Jn.prototype.hide=ia;Jn.prototype.render=ra;Jn.prototype.tick=na;h(Jn,Kn);function sa(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var n=this.parent();var a=this.__execs__.field;var s=this.isMixed();var e=function t(e,i){return{name:"key",value:i}};var i=function t(e,i){var r=void 0;if(s){r=e.key}else if(n&&n.isMixed()){r=e.key}else{r=a.y.field()}return{name:r,value:i}};return this.renderTooltip({dx:this.size().range[0]+4,value:i,key:e},t)}function oa(){var t=this.__execs__.canvas;var e=this.__execs__.field;var i=t.select(Z("multi-tooltip-g",true));if(i.empty())i=t.append("g").attr("class",Z("multi-tooltip-g"));var r=sa.call(this,true);var n=qn().target(this).dx(this.size().range[0]).dy(this.size().range[0]).color(this.color()[0]).tooltip(r).sortByValue(this.multiTooltip().sortByValue).keyFormat(e.x.format());n.render(i.node());this.__execs__.tooltip=n;var a=this.__execs__.multiTooltipDispatch;n.on("start",function(t){a.call("selectStart",this,t);a.call("multiTooltip",this,t)}).on("move",function(t){a.call("selectMove",this,t);a.call("multiTooltip",this,t)}).on("end",function(){a.call("selectEnd",this);a.call("multiTooltip",this)});return n}function la(){if(!this.isFacet()&&this.multiTooltip())oa.call(this);else if(this.tooltip()&&!this.multiTooltip())sa.call(this,false)}function ca(){var t=this;var e=this.__execs__.scale.x;if(!e.invert)return;var i=this.__execs__.canvas;var r=this.zoomExtent(this.isNested());var n=this.parent();var a=X.zoom().scaleExtent(r).translateExtent([[0,0],[(n?n:this).width(),(n?n:this).height()]]);i.call(a);this.zoomGen(a).zoomed(function(){Dn.call(t,true);t.resetTooltip();la.call(t)})}function ua(){if(this.stream()){this.streamPanning(this.__execs__.scale.x)}if(!this.zoom())return;if(this.zoom()==="normal")ca.call(this)}function fa(t,e){t.attr("transform","translate("+[e.width,0]+")")}function ha(){var t=this.unit();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".unit-text").empty()){e.append("text").attr("class","unit-text")}var n=e.select(".unit-text");n.text(t).style("font-family","Noto Sans KR").style("font-size","22px").style("font-weight","600").style("fill","#C6CBCE").attr("text-anchor","end").call(fa,r)}function da(t,e){t.attr("transform","translate("+[-85,0]+")")}function va(){var t=this.title();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".title_text").empty()){e.append("text").attr("class","title_text")}var n=e.select(".title_text");n.text(t).style("font-family","Noto Sans KR").style("font-size","40px").style("font-weight","bold").style("fill","#FFFFFF").attr("text-anchor","start").call(da,r)}var _a={range:[2,2],scale:"linear",reverse:false};var pa=["line","area"];var ma=["normal","count","mixed"];var ga={meanLine:false,multiTooltip:false,padding:0,pointRatio:2,regionPadding:.1,shape:pa[0],scaleBandMode:false,size:_a,individualScale:false};var ya=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(ga);t.__execs__.multiTooltipDispatch=X.dispatch("selectStart","selectMove","selectEnd","multiTooltip");t.rebindOnMethod(t.__execs__.multiTooltipDispatch);t.process("munge",Mn,{isPre:true}).process("unit",ha).process("title",va).process("brushZoom",Pn,{isPre:true,allow:function t(){return this.isBrushZoom()}}).process("domain",En,{isPre:true,allow:function t(){return!this.isBrushZoom()}}).process("range",Rn,{isPre:true,allow:function t(){return!this.isBrushZoom()}}).process("axis",Bn,{allow:function t(){return!this.isBrushZoom()}}).process("region",Vn,{allow:function t(){return!this.isBrushZoom()}}).process("facet",Gn,{allow:function t(){return!this.isBrushZoom()&&this.isFacet()}}).process("mark",Dn,{allow:function t(){return!this.isBrushZoom()&&!this.isFacet()}}).process("meanLine",In,{allow:function t(){return!this.isBrushZoom()}}).process("fitLine",Xn,{allow:function t(){return!this.isBrushZoom()}}).process("tooltip",la,{allow:function t(){return!this.isBrushZoom()}}).process("panning",Ln,{allow:function t(){return!this.isBrushZoom()}}).process("zoom",ua,{allow:function t(){return!this.isBrushZoom()}}).process("brush",Tn,{allow:function t(){return!this.isBrushZoom()}}).process("legend",On,{allow:function t(){return!this.isBrushZoom()}});return t}n(e,[{key:"renderCanvas",value:function t(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderCanvas",this).call(this,this.point()?this.size().range[0]*2:0)}},{key:"multiTooltip",value:function t(e){if(!arguments.length)return this.__attrs__.multiTooltip;if(typeof e==="boolean"){if(e){e={sortByValue:"natural"}}}if((typeof e==="undefined"?"undefined":u(e))==="object"){if(!e.sortByValue)e.sortByValue="natural"}this.__attrs__.multiTooltip=e;return this}},{key:"leastSquare",value:function t(e){var r=this.measureName();var n=this.isIndividualScale();return this.__execs__.munged.filter(function(t){if(typeof e==="string"){return t.data.key===e}else{return true}}).map(function(t){var e=t.children.map(function(t){return{x:t.data.key,y:t.data.value[r]}});var i=N(e);if(n&&t.scale){i.scale=t.scale}i.key=t.data.key;return i})}},{key:"measureName",value:function t(){var e=this.measures();var i=void 0;if(this.condition()===ma[2])i=R.field;else if(this.aggregated()&&e[0].field===R.field)i=e[0].field;else i=e[0].field+"-"+e[0].op;return i}},{key:"isCount",value:function t(){return this.condition()===ma[1]}},{key:"isFacet",value:function t(){return this.facet()&&this.isNested()&&!this.stacked()}},{key:"isIndividualScale",value:function t(){return this.individualScale()&&this.isNested()&&!this.stacked()}},{key:"isMixed",value:function t(){return this.condition()==ma[2]}},{key:"isNested",value:function t(){var e=this.dimensions();var i=this.condition();return e.length===2||i==ma[2]&&e.length===1}},{key:"isStacked",value:function t(){return this.stacked()&&this.isNested()}},{key:"muteFromLegend",value:function t(e){this.muteRegions(e.key)}},{key:"muteToLegend",value:function t(e){this.muteLegend(e.parent.data.key)}},{key:"demuteFromLegend",value:function t(e){this.demuteRegions(e.key)}},{key:"demuteToLegend",value:function t(e){this.demuteLegend(e.parent.data.key)}},{key:"showMultiTooltip",value:function t(e,i){if(this.multiTooltip()){var r=this.__execs__.tooltip;r.tick(e,i)}}}]);return e}(_(pr).with(dn,mn,fn,An,gr,Sn,zr,Mr));ya.prototype.meanLine=c("meanLine");ya.prototype.scaleBandMode=c("scaleBandMode");ya.prototype.individualScale=c("individualScale");ya.prototype.areaGradient=c("areaGradient");ya.prototype.diffWithArrow=c("diffWithArrow");function xa(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;return t.munged(e).level(i).aggregated(r).domain(0,n)}ya.prototype.unit=c("unit");ya.prototype.title=c("title");ya.prototype.dimension12=c("dimension12");var ka=m(ya);function wa(){var r=this;var n=this.__execs__.scale;var a=this.grid();var s=this.innerSize();var o=this.__execs__.field;var t=function t(e){o.x.axis(e);var i=r.axisDefault(n.x,e);if(e.orient==="bottom")i.y(n.y.range()[0]);i.grid(a).gridSize(s.height);return i};var e=function t(e){o.y.axis(e);var i=r.axisDefault(n.y,e);if(e.orient==="right")i.x(n.x.range()[1]);i.grid(a).gridSize(s.width);return i};var i=this.axisX();var l=this.axisY();if(this.isFacet()){this.axisFacet()}else{if(i){t(i)}if(l){e(l)}}this.renderAxis()}function ba(){var t=this.keep();var e=this.scale();var i=this.__execs__.munged;var r=this.__execs__.field;var n=this.aggregated();var a=this.viewInterval();var s=void 0,o=void 0;if(this.isColor()){s=r.region.munged(i).domain();e.color=this.updateColorScale(s,t)}if(this.isFacet()){e.region=X.scaleBand().domain(s).padding(this.regionPadding());return}var l=n?this.data().children:this.data();var c=X.extent(l,function(t){return(n?t.data:t)[r.x.field()]});var u=X.extent(l,function(t){return(n?t.data:t)[r.y.field()]});if(!t){e.x=S(c,undefined,r.x);e.y=S(u,undefined,r.y)}if(this.isSized()){o=X.extent(l,function(t){return t[r.radius.field()]});e.r=X.scaleLinear().domain(o)}if(!t&&a){c=this.limitViewInterval(e.x,c);e.x.domain(c)}else if(t&&this.stream()){c=this.limitViewInterval(e.x,c,true);e.x.domain(c)}else{this.setCustomDomain("x",c)}this.setCustomDomain("y",u);return this}function za(){var e=this;var r=this;var n=this.__execs__.scale;var t=this.facet();var i=this.__execs__.canvas;var a=this.innerSize();var s=this.measures();var o=void 0,l=void 0;var c=["axisTitles","size","grid","font","label","tooltip"].map(function(t){return{key:t,value:e[t]()}});var u=this.axisX();var f=this.axisY();var h=function t(e){var i=Va().container(this).data(e).measures(s).width(o).height(l).legend(false).zeroMargin(true).aggregated(true).parent(r).color(n.color(e.data.key));c.forEach(function(t){return i[t.key](t.value)});if(f)i.axis({target:"y",orient:"left"});if(u)i.axis({target:"x",orient:"bottom"});i.render()};if(t.orient==="horizontal"){o=n.region.bandwidth();l=a.height}else{o=a.width;l=n.region.bandwidth()}i.selectAll(".facet").each(h)}var Aa="#c0ccda";function Na(){var t=this.__execs__.canvas;var e=t.select(Z("fit-line-g",true));if(!this.fitLine()){if(!e.empty())t.select(Z("fit-line-g",true)).remove();return}var i=this.__execs__.field;var r=N(this.data(),i.x.field(),i.y.field()),n=r.slope,a=r.intercept;var s=this.scale();var o=X.transition().duration(this.transition().duration).delay(this.transition().delay);var l=s.x.domain();var c=l.map(function(t){return n*t+a});if(e.empty()){e=t.append("g").attr("class",Z("fit-line-g")).attr("clip-path","url(#"+t.selectAll(Z("canvas-g-clip-path",true)).attr("id"));e.append("line").attr("class",Z("fit-line")).style("fill","none").style("stroke",Aa).style("stroke-width",1).attr("x1",s.x(l[0])).attr("y1",s.y.range()[0]).attr("x2",s.x(l[1])).attr("y2",s.y.range()[0])}e.select("line").transition(o).attr("x1",s.x(l[0])).attr("y1",s.y(c[0])).attr("x2",s.x(l[1])).attr("y2",s.y(c[1]))}function Fa(){var t=this.legend();if(!t)return;if(!this.isColor()){return}this.renderLegend()}function Sa(){var t=this.scale();var e=this.facet();var i=this.axisX();var r=this.axisY();if(this.isFacet()){t.region.padding(this.regionPadding());if(e.orient==="horizontal"&&i){i.orient="top";i.showDomain=false;this.thickness(i,t.region,true,true);if(r)r.thickness=0}else if(e.orient==="vertical"&&r){r.orient="right";r.showDomain=false;this.thickness(r,t.region,false,true);if(i)i.thickness=0}var n=this.innerSize();if(e.orient==="vertical"){t.region.rangeRound([0,n.height])}else{t.region.rangeRound([0,n.width])}return}if(this.isSized()){t.r.range(this.size().range)}this.thickness(r,t.y,false,false);if(!this.stream())this.thickness(i,t.x,true,false);var a=this.innerSize();t.x.rangeRound([0,a.width]);t.y.rangeRound([a.height,0])}function Ta(){var i=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var a=this;var t=this.__execs__.canvas;var r=this.__execs__.scale;var s=this.color();var o=this.size();var l=this.label();var c=X.transition().duration(this.transition().duration).delay(this.transition().delay);var u=this.__execs__.field;var f=this.aggregated();var h=this.isColor();var d=this.stream();var v=function t(e){return r.x(e.data[u.x.field()])};var _=function t(e){return r.y(e.data[u.y.field()])};var p=function t(e){return i.isSized()?r.r(e.data[u.radius.field()]):o.range[0]};var m=function t(){var e=X.select(this.parentNode).datum();return h?r.color(e.data.key):s[0]};var g=function t(e){e.each(function(t){t.x=v(t);if(d){var e=t.data[u.x.field()];var i=a.distDomain(r.x);if(e>r.x._lastDomain[r.x._lastDomain.length-1]){t.x0=t.x+i}}t.y=_(t);t.color=m.call(this);t.r=p(t);t.text=Y(t.x)+", "+Y(t.y)})};var y=function t(e){e.attr("r",0).attr("stroke",function(t){return t.color}).attr("stroke-width","1px").attr("fill-opacity",.5).style("cursor","pointer")};var x=function t(e){e.transition(c).attr("r",function(t){return t.r}).attr("stroke",function(t){return t.color})};var k=function t(e){e.each(function(t){var e=X.select(this);e.style("pointer-events","none").text(t.text);a.styleFont(e)})};var w=function t(e){e.each(function(t){var e=X.select(this);e.attr("text-anchor",t.anchor).style("visibility",l?"visible":"hidden").transition(c).attr("y",o.range[0]).text(t.text);a.styleFont(e)})};var e=function t(e){var i=e.selectAll(a.nodeName()).data(function(t){return h||f?t.children:t});i.exit().remove();var r=i.enter().append("g").attr("class",a.nodeName(true)+" point").call(g).attr("transform",function(t){return"translate("+[t.x0||t.x,t.y]+")"});r.append("circle").call(y);r.append("text").call(k);i=r.merge(i).call(g);i.selectAll("circle").call(x);i.selectAll("text").call(w);i.each(function(t){var e=X.select(this);if(!n)e=e.transition(c);e.attr("transform","translate("+[t.x,t.y]+")").style("fill",t.color)});a.__execs__.nodes=i};t.selectAll(this.regionName()).call(e)}function Oa(){var t=function t(e,i){var r=this.__execs__.field;if(i.length<2)throw new x;r.x=I(i[0]);r.y=I(i[1]);if(e.length===0&&i.length===2)return Ba[0];else if(e.length===1&&i.length===2){r.region=Xr(e[0]);return Ba[1]}else if(e.length===0&&i.length===3){r.radius=I(i[2]);return Ba[2]}else if(e.length==1&&i.length===3){r.radius=I(i[2]);r.region=Xr(e[0]);return Ba[3]}else throw new x};this.condition(t);this.limitRows();if(this.aggregated()){this.__execs__.munged=[this.data()]}else if(this.isColor()){this.__execs__.munged=this.aggregate(false,false).map(function(t){t.key=t.data.key;return t})}else{this.__execs__.munged=[this.data().map(function(t){return{data:t}})]}}function Pa(){if(this.stream()){this.streamPanning(this.__execs__.scale.x)}}function Da(){var i=this.aggregated();var r=this.__execs__.scale;var n=this.isFacet();var a=this.facet();this.renderRegion(function(t){if(i)return;var e=[n?r.region(t.key):0,0];if(a.orient==="vertical")e.reverse();t.x=e[0];t.y=e[1]},function(t){return t},n)}function Ma(){if(!this.tooltip()||this.isFacet())return;var i=this.measures();var t=function t(e){return i.map(function(t){return{name:t.field,value:t.format?t.format(e.data[t.field]):e.data[t.field]}})};this.renderTooltip({dx:this.size().range[0]+4,value:t,key:null})}function La(){var e=this;var t=this.__execs__.canvas;var i=this.__execs__.field;var r=this.innerSize();var n=this.__execs__.scale;var a=this.__execs__.axis;var s=a&&a.x?a.x[i.x.field()]:null;var o=a&&a.y?a.y[i.y.field()]:null;var l=X.brush().extent([[0,0],[r.width,r.height]]);var c=t.selectAll(".brush.x").data([r]);c.exit().remove();c=c.enter().append("g").attr("class","brush x").merge(c).attr("transform","translate("+[0,0]+")").call(l);this.brushGen(l);var u=this.zoomExtent(this.isColor(),true);var f=X.zoom().scaleExtent(u).translateExtent([[0,0],[this.width(),this.height()]]);t.call(f);this.zoomGen(f);var h=n.x.domain();var d=n.y.domain();var v=void 0;l.on("end.scatter",function(){if(X.event.sourceEvent&&X.event.sourceEvent.type==="end")return;var t=X.event.selection;if(!t){if(!v)return v=setTimeout(function(){v=null},300);n.x.domain(h);n.y.domain(d)}else{n.x.domain([t[0][0],t[1][0]].map(n.x.invert,n.x));n.y.domain([t[1][1],t[0][1]].map(n.y.invert,n.y))}if(s){s.render(null)}if(o){o.render(null)}Ta.call(e);e.brushMove(c,null)})}function Ca(){var t=this;var e=this.zoomExtent(this.isColor(),true);var i=X.zoom().scaleExtent(e).translateExtent([[0,0],[this.width(),this.height()]]);this.__execs__.canvas.call(i);this.zoomGen(i).zoomed(function(){Ta.call(t,true);t.resetTooltip();Ma.call(t)},true)}function Ea(){if(!this.zoom())return;if(this.zoom()==="normal")Ca.call(this);else if(this.zoom()==="brush")La.call(this)}var Ra={range:[3,12],scale:"linear",reverse:false};var Ba=["normal","color","bubble","mixed"];var ja={regionPadding:.1,size:Ra};var Ia=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(ja);t.process("munge",Oa,{isPre:true}).process("domain",ba,{isPre:true}).process("range",Sa,{isPre:true}).process("axis",wa).process("fitLine",Na).process("region",Da).process("facet",za,{allow:function t(){return this.isFacet()}}).process("mark",Ta,{allow:function t(){return!this.isFacet()}}).process("legend",Fa).process("tooltip",Ma).process("panning",Pa).process("zoom",Ea);return t}n(e,[{key:"renderCanvas",value:function t(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderCanvas",this).call(this,this.size().range[this.isSized()?1:0]*1.25)}},{key:"isColor",value:function t(){return this.condition()===Ba[1]||this.condition()===Ba[3]}},{key:"isSized",value:function t(){return this.condition()===Ba[2]||this.condition()===Ba[3]}},{key:"isFacet",value:function t(){return this.facet()&&this.isColor()}},{key:"muteFromLegend",value:function t(e){this.muteRegions(e.key)}},{key:"demuteFromLegend",value:function t(e){this.demuteRegions(e.key)}},{key:"muteToLegend",value:function t(e){this.muteLegend(e.parent.data.key)}},{key:"demuteToLegend",value:function t(e){this.demuteLegend(e.parent.data.key)}}]);return e}(_(pr).with(dn,fn,An,gr,Mr));var Va=m(Ia);function Ga(){var t=function t(e,i){var r=this.__execs__.field;if(e.length!==2)throw new x;var n=Xr(e[0]);var a=Xr(e[1]);if(this.reverse()){r.x=a;r.y=n}else{r.x=n;r.y=a}if(e.length===2){if(i.length===0)this.measure(C);r.color=I(i[0]);if(i.length===0)return qa[1];else if(i.length===1)return qa[0]}else throw new x};this.condition(t);this.__execs__.munged=this.aggregate(this.reverse(),true);this.limitKeys()}function Ha(){var t=this.scale();var e=this.__execs__.munged;var i=this.__execs__.field;var r=i.x.munged(e).level(0).domain(this.sortByValue());var n=i.y.munged(e).level(1).domain(this.sortByValue());var a=i.color.munged(e).level(1).domain();t.x=X.scaleBand().domain(r);t.y=X.scaleBand().domain(n);t.color=X.scaleLinear();if(E(a)){t.color.domain([a[0],0,a[a.length-1]])}else{t.color.domain(a)}return this}function Xa(){var t=this.scale();var e=this.__execs__.field;var i=this.axisX();var r=this.axisY();e.x.axis(i);e.y.axis(r);this.thickness(r,t.y,false,true);this.thickness(i,t.x,true,true);var n=this.innerSize();t.x.rangeRound([0,n.width]).padding(this.padding());t.y.rangeRound([0,n.height]).padding(this.padding());t.color.range(this.color());return this}function Ya(){var n=this;var t=this.__execs__.canvas;var a=this.__execs__.scale;var i=this.label();var r=X.transition().duration(this.transition().duration).delay(this.transition().delay);var s=function t(e){return a.y(e.data.key)};var o=function t(e){return a.color(e.value)};var l=function t(e){return Y(e.value)};var c=function t(e){var i=a.x.bandwidth();var r=a.y.bandwidth();e.each(function(t){t.x=0;t.y=s(t);t.value=t.value;t.color=o(t);t.text=l(t);t.w=i;t.h=r})};var u=function t(e){e.attr("width",function(t){return t.w}).attr("height",function(t){return t.h}).style("stroke","none").style("fill",function(t){return t.color}).style("cursor","pointer")};var f=function t(e){e.transition(r).attr("width",function(t){return t.w}).attr("height",function(t){return t.h}).style("fill",function(t){return t.color})};var h=function t(e){e.each(function(t){var e=X.select(this);e.attr("x",0).attr("y",0).attr("dx","0.29em").attr("dy","1em").style("pointer-events","none").style("fill","#111").text(t.text);n.styleFont(e)})};var d=function t(e){e.each(function(t){var e=X.select(this);e.attr("text-anchor",t.anchor).style("visibility",i?"visible":"hidden").transition(r).text(t.text);n.styleFont(e)})};var e=function t(e){var i=e.selectAll(n.nodeName()).data(function(t){return t.children},function(t){return t.data.key});i.exit().remove();var r=i.enter().append("g").attr("class",n.nodeName(true)+" point").call(c);r.append("rect").call(u);r.append("text").call(h);i=r.merge(i).call(c);i.selectAll("rect").call(f);i.selectAll("text").call(d);i.attr("transform",function(t){return"translate("+[t.x,t.y]+")"}).style("fill",function(t){return t.color});n.__execs__.nodes=i};var v=t.selectAll(this.regionName());v.call(e)}function Za(){var r=this;var n=this.__execs__.scale;var a=this.__execs__.field;var t=function t(e){a.x.axis(e);var i=r.axisDefault(n.x,e);if(e.orient==="bottom")i.y(n.y.range()[1]);return i};var e=function t(e){a.y.axis(e);var i=r.axisDefault(n.y,e);if(e.orient==="right")i.x(n.x.range()[1]);return i};var i=this.axisX();var s=this.axisY();if(i){t(i)}if(s){e(s)}this.renderAxis()}function Wa(){this.renderSpectrum()}function Ka(){var i=this.__execs__.scale;var t=function t(e){e.x=i.x(e.data.key);e.y=0};this.renderRegion(t)}function Ja(){if(!this.tooltip())return;var r=this.__execs__.field;var t=function t(e,i){return{name:r.color.field(),value:i}};var e=function t(e){return{x:e.w,y:0}};this.renderTooltip({offset:e,value:t,color:"#111"})}var qa=["normal","count"];var Ua={color:_i,padding:.05,reverse:false};var Qa=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(Ua);t.process("munge",Ga,{isPre:true}).process("domain",Ha,{isPre:true}).process("range",Xa,{isPre:true}).process("region",Ka).process("axis",Za).process("mark",Ya).process("spectrum",Wa).process("tooltip",Ja);return t}n(e,[{key:"isCount",value:function t(){return this.condition()===qa[1]}}]);return e}(_(fr).with(gr,wr));Qa.prototype.reverse=c("reverse");var $a=m(Qa);function ts(){var e=this;var t=function t(e,i){var r=this.__execs__.field;if(e.length===0)throw new x;if(this.shape()==="word"&&e.length>1)throw new x;r.root=Xr(e[0]);r.leaf=Xr(e[e.length-1]);if(i.length===1){r.color=I(i[0]);return ls[0]}else if(i.length===0){this.measure(C);r.color=I(i[0]);return ls[1]}else throw new x};this.condition(t);this.__execs__.munged=this.aggregate(false,true,true,false);var i=X.hierarchy({key:"root",values:this.__execs__.munged},function(t){return t.values}).sum(function(t){return t.value?t.value[e.measureName()]:0});if(this.sortByValue()==="ascending"){i.sort(function(t,e){return t.value-e.value})}else if(this.sortByValue()==="descending"){i.sort(function(t,e){return e.value-t.value})}var r=this.size()?this.size().range:this.innerSize(true);if(this.shape()==="pack"){var n=X.pack().size(r);i=n(i)}else{var a=X.treemap().size(r).paddingTop(this.font()["font-size"]+4);i=a(i)}this.__execs__.munged=i}function es(){var t=this.scale();var e=this.__execs__.munged;var i=X.extent(e.leaves(),function(t){return t.value});t.color=X.scaleLinear();if(E(i)){t.color.domain([i[0],0,i[i.length-1]])}else{t.color.domain(i)}return this}function is(){var t=this.scale();t.color.range(this.color());return this}var rs="#eee";function ns(){var i="treemap-node-clip-path-";var n=this;var r=this.__execs__.mark;var a=this.__execs__.scale;var s=this.label();var o=X.transition().duration(this.transition().duration).delay(this.transition().delay);var l=this.size();var c=this.shape();var u=this.innerSize();var f=c==="pack"?"circle":"rect";var h=function t(e){if(f==="rect"){e.attr("width",function(t){return t.w}).attr("height",function(t){return t.h})}else{e.attr("r",function(t){return t.r})}};var d=function t(e){if(c==="treemap"){e.attr("dx","0.29em").attr("dy","1em")}else if(c==="word"){var i=e.datum();var r=i.w<i.h;e.attr("dy",r?"-.35em":".8em").attr("textLength",r?i.h:i.w).attr("lengthAdjust","spacingAndGlyphs").attr("transform",r?"rotate(90)":"").style("font-size",(r?i.w:i.h)-1+"px").style("fill",i.color).style("pointer-events","all").style("cursor","pointer")}else{var n=e.datum();e.attr("visibility",n.children?"hidden":"visible").attr("text-anchor","middle").attr("dy",".35em")}};var v=function t(e){return e.children?rs:a.color(e.value)};var _=function t(e){return Y(e.value)};var p=function t(e){var i=0;var r=0;if(l||c==="pack"){i=(u.width-l.range[0])/2;r=(u.height-l.range[1])/2}e.each(function(t){t.color=v(t);t.text=_(t);if(c!=="pack"){t.x=t.x0+i;t.y=t.y0+r;t.w=t.x1-t.x0;t.h=t.y1-t.y0}else{t.x+=i/2;t.y+=r/2}})};var m=function t(e){e.each(function(t){X.select(this).attr("id",A(i)).append(f).call(h,t)})};var g=function t(e){e.each(function(t){X.select(this).select(f).transition(o).call(h,t)})};var y=function t(e){e.style("visibility",c==="word"?"hidden":"visible").style("stroke","none").style("fill",function(t){return t.color}).style("cursor","pointer").call(h)};var x=function t(e){e.style("visibility",c==="word"?"hidden":"visible").transition(o).style("fill",function(t){return t.color}).style("stroke",function(t){return t.children?"#ddd":"none"}).call(h)};var k=function t(e){e.each(function(){var t=r.get(this);var e=X.select(this);e.attr("x",0).attr("y",0).style("pointer-events","none").style("fill","#000").text(function(t){return t.data.key});n.styleFont(e);e.call(d,t);e.style("font-weight","bold")})};var w=function t(e){e.each(function(){var t=X.select(this);t.text(function(t){return t.data.key});n.styleFont(t);t.style("font-weight","bold");t.call(d,r.get(this))})};var b=function t(e){e.each(function(t){var e=X.select(this);var i=e.attr("x",0).attr("y",0).style("pointer-events","none").style("fill","#111").text(t.text);if(f==="rect"){i.attr("dx","0.29em").attr("dy","2em")}else{i.attr("visibility",t.children?"hidden":"visible").attr("text-anchor","middle").attr("dy","1.35em")}n.styleFont(e)})};var z=function t(e){e.each(function(t){var e=X.select(this);e.style("visibility",s&&c!=="word"?"visible":"hidden").transition(o).text(t.text);n.styleFont(e)})};var t=function t(e){var i=e.selectAll(n.nodeName()).data(function(t){return t.descendants().slice(1)},function(t){return t.data.key});i.exit().remove();var r=i.enter().append("g").attr("class",function(t){return n.nodeName(true)+" "+Z(t.children?"stem":"leaf")}).call(p);r.append("defs").append("clipPath").call(m);r.append(f).attr("class","shape").call(y);r.append("text").attr("class","name").call(k);r.filter(function(t){return!t.children}).append("text").attr("class","label").call(b);r.attr("clip-path",function(){return"url(#"+X.select(this).select("clipPath").attr("id")+")"});i=r.merge(i).call(p);i.select("defs").select("clipPath").call(g);i.selectAll(".shape").call(x);i.selectAll(".name").call(w);i.selectAll(".label").call(z);i.attr("transform",function(t){return"translate("+[t.x,t.y]+")"});n.__execs__.nodes=i};this.renderRegion(function(t){t.x=0;t.y=0},function(t){return[t]}).call(t)}function as(){this.renderSpectrum()}function ss(){if(!this.tooltip())return;var n=this.__execs__.field;var a=this.isCount();var i=this.shape();var t=function t(e){return{name:"key",value:e.data.key}};var e=function t(e,i){var r=void 0;if(a){r=L}else{r=n.color.field()}return{name:r,value:i}};var r=function t(e){return{x:i==="pack"?e.r:e.w,y:0}};this.renderTooltip({offset:r,value:e,key:t,color:"#111"},false,true)}var os=["treemap","pack","word"];var ls=["normal","count"];var cs={autoResizeSkip:["domain"],color:_i,reverse:false,shape:os[0],size:null,sortByValue:"natural"};var us=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(cs);t.process("munge",ts,{isPre:true}).process("domain",es,{isPre:true}).process("range",is,{isPre:true}).process("mark",ns).process("spectrum",as).process("tooltip",ss);return t}n(e,[{key:"axis",value:function t(){if(!arguments.length)return[];return this}},{key:"isCount",value:function t(){return this.condition()===ls[1]}}]);return e}(_(gi).with(Sn,wr));us.prototype.reverse=c("reverse");var fs=m(us);function hs(t,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return t.map(function(e){return i.map(function(t){return{data:{x:t.field,y:(r?e.data:e)[t.field]}}})})}function ds(){var i=this;var t=function t(e,i){var r=this;var n=this.__execs__.field;if(i.length<2)throw new x;n.x=Xr(this.mixedDimension());i.forEach(function(t){n[Es(t)]=I(t);if(r.shape()===Ps[1])n[Cs(t)]=I(t)});if(e.length===0)return Ds[0];else if(e.length===1){n.region=Xr(e[0]);return Ds[1]}else throw new x};this.condition(t);var r=void 0;var n=this.measures();this.limitRows();if(this.shape()===Ps[0]){if(this.isColor()){r=this.aggregate(false,false);r.forEach(function(t){t.key=t.data.key;t.children=hs(t.children,n,true)})}else{r=[{parent:null,children:hs(this.data(),n)}]}}else{r=[];n.forEach(function(e){n.forEach(function(t){r.push({xField:e,yField:t,children:i.data()})})})}this.__execs__.munged=r}function vs(t,i){var r=[];t.forEach(function(e){e=e[i.field()];if(i.interval()){e=g[i.interval()](e)}if(e instanceof Date&&r.findIndex(function(t){return t-e===0})<0)r.push(e);else if(!r.includes(e))r.push(e)});r.sort(z(i.order()));return r}function _s(t){var r=this;this.axis("x",false);var n=this.scale();var e=this.measures();var i=this.__execs__.munged;var a=this.__execs__.field;if(this.isColor()){var s=a.region.munged(i).domain();n.color=this.updateColorScale(s,t)}n.x=X.scalePoint().domain(e.map(function(t){return t.field}));e.forEach(function(e){var t=X.extent(r.data(),function(t){return t[e.field]});var i=Es(e);n[i]=S(t,null,a[i]);r.setCustomDomain(i,t)});return this}function ps(t){var n=this;var a=this.scale();var e=this.measures();var i=this.__execs__.field;if(this.isColor()){var r=vs(this.data(),i.region);a.color=this.updateColorScale(r,t)}a.region=X.scaleBand().domain(e.map(function(t){return t.field}));e.forEach(function(e){var t=X.extent(n.data(),function(t){return t[e.field]});var i=Es(e);a[i]=S(t);n.setCustomDomain(i,t);var r=Cs(e);a[r]=S(t);n.setCustomDomain(r,t)})}function ms(t){if(this.isParcoords())_s.call(this,t);else ps.call(this,t)}function gs(){var i=this.scale();var r=this.innerSize();var t=this.measures();i.x.rangeRound([0,r.width]);t.forEach(function(t){var e=Es(t);i[e].rangeRound([r.height,0])})}function ys(){var r=this.scale();var t=this.innerSize();var e=this.measures();var i=Math.min(t.width,t.height);r.region.rangeRound([0,i]).padding(this.regionPadding());e.forEach(function(t){var e=Es(t);r[e].rangeRound([r.region.bandwidth(),0]);var i=Cs(t);r[i].rangeRound([0,r.region.bandwidth()])})}function xs(t){if(this.isParcoords())gs.call(this,t);else ys.call(this,t)}function ks(){var n=this;var t=this.__execs__.canvas;var e=this.__execs__.scale;var i=this.size();var r=this.innerSize();var a=X.transition().duration(this.transition().duration).delay(this.transition().delay);var s=X.line().x(function(t){return e.x(t.data.x)}).y(r.height);var o=X.line().x(function(t){return e.x(t.data.x)}).y(function(t){return e[Es(t.data.x)](t.data.y)});var l=function t(e){e.attr("d",s).attr("fill","none").attr("stroke-width",i.range[0])};var c=function t(e){e.transition(a).attr("d",o).attr("stroke-width",i.range[0])};var u=function t(e){var i=e.selectAll(n.seriesName()).data(function(t){return t.children},function(t,e){return t.key?t.key:e});i=i.enter().append("g").attr("class",n.seriesName(true)).merge(i);var r=i.selectAll("path"+Z("line",true)).data(function(t){return[t]});r.enter().append("path").attr("class",Z("line")).call(l).merge(r).call(c)};var f=t.selectAll(this.regionName());f.call(u)}function ws(){var n=this;var t=this.measures();var a=this.__execs__.scale;var s=function t(e,i){var r=n.axisDefault(e,i);if(i.orient==="right")r.x(a.x.range()[1]);r.x(a.x(i.field));return r};var o=this.axisY();if(o){t.forEach(function(t){var e=Es(t);var i=a[e];var r={target:o.target,field:t.field,orient:o.orient,showDomain:true,titleOrient:"bottom",showTitle:true};s(i,r)})}}function bs(){if(this.shape()===Ps[0]){ws.call(this)}this.renderAxis()}function zs(){if(!this.isColor()){return}this.renderLegend()}function As(){var i=this.isColor();var r=this.color();var n=this.shape();var a=this.__execs__.scale;var t=function t(e){if(n===Ps[0]){e.x=0;e.y=0;e.color=i?a.color(e.data.key):r[0]}else{e.x=a.region(e.xField.field);e.y=a.region.range()[1]-a.region(e.yField.field)-a.region.bandwidth()}};this.renderRegion(t,function(t){return t},n===Ps[1],n===Ps[1]?".matrix":"").style("stroke",function(t){return t.color})}function Ns(){var e=this;var s=this;var t=this.__execs__.scale;var i=this.__execs__.canvas;var o=this.measures();var l=this.dimensions();var c=t.region.bandwidth();var u=["axisTitles","color","size","grid","font","label"].map(function(t){return{key:t,value:e[t]()}});var r=function t(e,i){var r=Va().container(this).data(e.children).dimensions(l).measures([e.xField,e.yField]).width(c).height(c).legend(false).tooltip(false).parent(s).zeroOffset(true).noAxisOffset(true);var n=i%o.length===0;var a=i<o.length;u.forEach(function(t){return r[t.key](t.value)});r.axis({target:"y",orient:"left",showTitle:a,showTicks:a});r.axis({target:"x",orient:"bottom",showTitle:n,showTicks:n});r.render()};i.selectAll(".facet").each(r)}function Fs(){var t=this.__execs__.canvas;var e=this.__execs__.scale;var i=this.innerSize();var r=this.measures();var s={};var n=this.font()["font-size"];var a=X.brushY().extent([[-n,0],[n,i.height]]);var o=t.selectAll(this.seriesName());var l=function t(){o.attr("opacity","1").filter(function(a){var t=function t(e){var i=s[e];var r=a.filter(function(t){return t.data.x===e})[0];var n=r.data.y<i[1]||r.data.y>i[0];if(n)return{v:true}};for(var e in s){var i=t(e);if((typeof i==="undefined"?"undefined":u(i))==="object")return i.v}return false}).attr("opacity",.1)};var c=t.selectAll(".brush.y").data(r,function(t){return t.field});c.exit().remove();c.enter().append("g").attr("class","brush y").merge(c).attr("transform",function(t){return"translate("+[e.x(t.field),0]+")"}).call(a);a.on("brush.parCoords",function(t){s[t.field]=X.event.selection.map(e[Es(t.field)].invert);l()}).on("end.parCoords",function(t){if(X.event.selection===null){delete s[t.field];l()}});this.brushGen(a)}function Ss(){var t=this.__execs__.canvas;var s=this.__execs__.scale;var e=s.region.bandwidth();var i=X.brush().extent([[0,0],[e,e]]);var o=t.selectAll(this.nodeName());var r=void 0;var n=t.selectAll(".brush.matrix").data(function(t){return t});n.exit().remove();n.enter().append("g").attr("class","brush matrix").merge(n).attr("transform",function(t){return"translate("+[s.region(t.xField.field),s.region.range()[1]-s.region(t.yField.field)-s.region.bandwidth()]+")"}).call(i);i.on("start.matrix",function(){if(r!==this){X.select(r).call(i.move,null);r=this}}).on("brush.matrix",function(t){if(X.event.selection===null)return;var e=t.xField.field;var i=t.yField.field;var r=s[Cs(e)];var n=s[Es(i)];var a=X.event.selection.map(function(t){return[r.invert(t[0]),n.invert(t[1])]});o.attr("opacity",1).filter(function(t){t=t.data;return t[e]<a[0][0]||t[e]>a[1][0]||t[i]>a[0][1]||t[i]<a[1][1]}).attr("opacity",.1)}).on("end.matrix",function(){if(X.event.selection===null){o.attr("opacity",1)}});this.brushGen(i)}function Ts(){if(this.shape()===Ps[0]){Fs.call(this)}else{Ss.call(this)}}var Os={range:[1,1],scale:"linear",reverse:false};var Ps=["par-coords","scatter-matrix"];var Ds=["normal","color"];var Ms={regionPadding:.1,size:Os,shape:Ps[0]};var Ls=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(Ms);t.brush(true);t.process("munge",ds,{isPre:true}).process("domain",ms,{isPre:true}).process("range",xs,{isPre:true}).process("axis",bs).process("region",As).process("mark",ks,{allow:function t(){return this.isParcoords()}}).process("facet",Ns,{allow:function t(){return!this.isParcoords()}}).process("legend",zs).process("brush",Ts);return t}n(e,[{key:"isColor",value:function t(){return this.condition()===Ds[1]}},{key:"isParcoords",value:function t(){return this.shape()===Ps[0]}},{key:"muteRegions",value:function t(e){var r=this;var i=function t(e){r.mute(e,r.muteIntensity())};var n=function t(e){var i=e.selectAll(r.nodeName()).classed("mute",true);r.mute(i,r.muteIntensity())};if(!arguments.length){if(this.isParcoords()){return this.filterRegions().call(i)}else{return this.regions().selectAll(this.regionName()).call(n)}}if(this.isParcoords()){return this.filterRegions(tt(e),true).call(i)}else{return this.regions().selectAll(this.regionName()).filter(tt(e)).call(n)}}},{key:"demuteRegions",value:function t(e){var r=this;var i=function t(e){r.demute(e)};var n=function t(e){var i=e.selectAll(r.nodeName());r.demute(i)};if(!arguments.length){if(this.shape()===Ps[0]){return this.filterRegions().call(i)}else{return this.regions().selectAll(this.regionName()).call(n)}}if(this.isParcoords()){return this.filterRegions(tt(e),true).call(i)}else{return this.regions().selectAll(this.regionName()).filter(tt(e)).call(n)}}},{key:"muteFromLegend",value:function t(e){this.muteRegions(e.key)}},{key:"demuteFromLegend",value:function t(e){this.demuteRegions(e.key)}}]);return e}(_(fr).with(mn,fn,gr,Sn));function Cs(t){return"x-"+(t.field?t.field:t)}function Es(t){return"y-"+(t.field?t.field:t)}var Rs=m(Ls);function Bs(){var t=function t(e,i){var r=this.__execs__.field;if(e.length===1){if(i.length===0)this.measure(C);r.r=I(i[0]);r.region=Xr(e[0]);if(i.length===0)return Ks[0];else if(i.length===1)return Ks[1]}else throw new x};this.condition(t);this.__execs__.munged=this.aggregate(false,true,false,false);this.limitKeys();var e=this.__execs__.field;var i=X.pie().value(function(t){return t.value[e.r.valueName()]}).padAngle(this.padding());if(this.sortByValue()){i.sortValues(this.sortByValue()==="ascending"?function(t,e){return t-e}:function(t,e){return e-t})}else{i.sortValues(function(t,e){return 0})}var r=i(this.__execs__.munged);r.forEach(function(t){return t.key=t.data.key});if(e.region.interval()){r.forEach(function(t){t.data.key=new Date(t.data.key)})}this.__execs__.munged=r}function js(t){var e=this.scale();var i=this.__execs__.munged;var r=this.__execs__.field;var n=r.region.munged(i).domain();e.color=this.updateColorScale(n,t)}function Is(){var n=this;var r=this.__execs__.scale;var i=this.label();var a=X.transition().duration(this.transition().duration).delay(this.transition().delay);var s=this.innerSize();var o=this.size();var l=this.font();var c=this.textWithLabel();var u=this.showType();var f=X.arc().innerRadius(o.range[0]).outerRadius(o.range[1]).startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}).padAngle(function(t){return t.padAngle});var h=function t(e){var i=X.interpolate({endAngle:0},e);return function(t){return f(i(t))}};var d=function t(e){var i=X.mean(o.range);e.each(function(t){t.mid=(t.endAngle+t.startAngle)/2;t.dx=Math.sin(t.mid)*i;t.dy=-Math.cos(t.mid)*i;t.x=s.width/2+t.dx;t.y=s.height/2+t.dy;t.color=r.color(t.key);t.labeltext=c?t.data.key:null;t.percentage=(t.endAngle-t.startAngle)*100/(Math.PI*2);if(u==="all"){t.text=Y(t.value)+"("+Y(t.percentage)+"%)"}else if(u==="percent"){t.text=Y(t.percentage)+"%"}else{t.text=Y(t.value)}})};var v=function t(e){e.style("fill",function(t){return t.color}).style("cursor","pointer")};var _=function t(e){e.style("fill",function(t){return t.color}).transition(a).attrTween("d",h)};var p=function t(e){e.each(function(t){X.select(this).attr("x",t.dx).attr("dy",".35em").attr("y",t.dy+l["font-size"]/2).attr("text-anchor","middle").style("pointer-events","none").text(t.text);n.styleFont(X.select(this))})};var m=function t(e){e.each(function(t){X.select(this).style("visibility",i?"visible":"hidden").text(t.text).transition(a).attr("x",t.dx).attr("y",t.dy);n.styleFont(X.select(this))})};var g=function t(e){e.each(function(t){X.select(this).attr("x",t.dx).attr("dy",".35em").attr("y",t.dy-l["font-size"]/2).attr("text-anchor","middle").style("pointer-events","none").text(t.labeltext);n.styleFont(X.select(this))})};var y=function t(e){e.each(function(t){X.select(this).style("visibility",i?"visible":"hidden").text(t.labeltext).transition(a).attr("x",t.dx).attr("y",t.dy);n.styleFont(X.select(this))})};var t=function t(e){var i=e.selectAll(n.nodeName()).data(function(t){return t},function(t){return t.data.key});i.exit().remove();var r=i.enter().append("g").attr("class",n.nodeName(true)+" pie").call(d);r.append("path").call(v);if(c){r.append("text").attr("class",n.nodeName(true)+" labeltext").call(g)}r.append("text").attr("class",n.nodeName(true)+" label").call(p);i.call(d);i=r.merge(i).attr("transform","translate("+[s.width/2,s.height/2]+")");i.select("path").call(_);if(c){i.select("labeltext").call(y)}i.select("label").call(m);n.__execs__.nodes=i};this.renderRegion(function(t){t.x=0;t.y=0},function(t){return[t]}).call(t)}function Vs(){if(!this.legend())return;this.renderLegend()}function Gs(){if(!this.tooltip())return;var n=this.isCount();var a=this.__execs__.field;var i=function t(e){var i=a.region.isInterval()?a.region.format():null;return i?i(e):e};var t=function t(e){return{name:"key",value:i(e.data.key)}};var e=function t(e,i){var r=void 0;if(n){r=L}else{r=a.region.field()}return{name:r,value:i}};this.renderTooltip({value:e,key:t})}function Hs(t,e){t.attr("transform","translate("+[e.width,0]+")")}function Xs(){var t=this.unit();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".unit-text").empty()){e.append("text").attr("class","unit-text")}var n=e.select(".unit-text");n.text(t).style("font-family","Noto Sans KR").style("font-size","22px").style("font-weight","600").style("fill","#C6CBCE").attr("text-anchor","end").call(Hs,r)}function Ys(t,e){t.attr("transform","translate("+[-85,0]+")")}function Zs(){var t=this.title();var e=this.__execs__.canvas;var i=X.transition().duration(this.transition().duration).delay(this.transition().delay);var r=this.innerSize();if(e.select(".title_text").empty()){e.append("text").attr("class","title_text")}var n=e.select(".title_text");n.text(t).style("font-family","Noto Sans KR").style("font-size","40px").style("font-weight","bold").style("fill","#FFFFFF").attr("text-anchor","start").call(Ys,r)}var Ws={range:[0,150],scale:"linear",reverse:false};var Ks=["normal","count"];var Js={limitKeys:20,padding:0,size:Ws};var qs=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(Js);t.process("munge",Bs,{isPre:true}).process("unit",Xs).process("title",Zs).process("domain",js,{isPre:true}).process("mark",Is).process("legend",Vs).process("tooltip",Gs);return t}n(e,[{key:"axis",value:function t(){if(!arguments.length)return[];return this}},{key:"muteFromLegend",value:function t(e){this.muteNodes(e.key)}},{key:"demuteFromLegend",value:function t(e){this.demuteNodes(e.key)}},{key:"muteToLegend",value:function t(e){this.muteLegend(e.data.key)}},{key:"demuteToLegend",value:function t(e){this.demuteLegend(e.data.key)}},{key:"isCount",value:function t(){return this.condition()===Ks[1]}}]);return e}(_(gi).with(gr,wr));qs.prototype.unit=c("unit");qs.prototype.title=c("title");qs.prototype.textWithLabel=c("textWithLabel");qs.prototype.showType=c("showType");var Us=m(qs);function Qs(){var t=function t(e,i){var r=this.__execs__.field;if(this.addr()){if(i.length<1)throw new x;r.addr=i[0];r.lat=no;r.lng=ao;if(i.length===2){r.radius=i[1];return oo[0]}else if(i.length===1){return oo[1]}}else{if(i.length<2)throw new x;if(i.length===3){r.lat=i[0];r.lng=i[1];r.radius=i[2];return oo[0]}else if(i.length===2){r.lat=i[0];r.lng=i[1];return oo[1]}}if(e.length===1){r.name=e[0]}throw new x};this.condition(t);this.limitRows();var i=this.__execs__.field;if(this.isSized())this.data().sort(function(t,e){return e[i.radius.field]-t[i.radius.field]});this.__execs__.munged=this.data()}function $s(){var t=X.select(this.container());var e=t.select(".frame.layer");if(e.empty()){e=t.append("div").attr("class","frame layer")}e.style("width",this.width()+"px").style("height",this.height()+"px");var i={center:new daum.maps.LatLng(33.450701,126.570667),level:3};var r=new daum.maps.Map(e.node(),i);r.setMapTypeId(daum.maps.MapTypeId[this.mapBaseType()]);if(this.overlayMapType())r.addOverlayMapTypeId(daum.maps.MapTypeId[this.overlayMapType()]);var n=new daum.maps.ZoomControl;r.addControl(n,daum.maps.ControlPosition.RIGHT);r.setZoomable(false);this.__execs__.map=r}function to(){var t=this.scale();var e=this.__execs__.field;if(this.isSized()){var i=X.extent(this.data(),function(t){return t[e.radius.field]});t.r=X.scaleLinear().domain(i.map(function(t){return Math.sqrt(t)}))}}function eo(t,e,i){e.addr2coord(t,function(t,e){if(t===daum.maps.services.Status.OK){return i(null,e.addr[0])}else{return i(t)}})}function io(t,e,i){var r=Math.pow(2,e);t.range([i.range[0]*r,i.range[1]*r])}function ro(){var h=this.__execs__.map;var d=this.__execs__.field;var v=this.__execs__.scale;var n=this.__execs__.dispatch;var _=this.addr();var p=this.label();var a=this.data();var m=this.isSized();var g=this.size();var y=this.color();var i=new daum.maps.services.Geocoder;var x=[];var s=function t(){var e=a.map(function(t){return new daum.maps.LatLng(t[d.lat.field],t[d.lng.field])});var i=new daum.maps.LatLngBounds;e.forEach(function(t){i.extend(t)});h.setBounds(i);var r=h.getLevel();if(m)io(v.r,r,g)};var o=function t(){var u=h.getLevel();var f=111111;a.forEach(function(t){var e=new daum.maps.LatLng(t[d.lat.field],t[d.lng.field]);var i=m?v.r(Math.sqrt(t[d.radius.field])):g.range[0]*Math.pow(2,u);var r={clickable:true,zIndex:10,center:e,radius:i,strokeColor:y[0],strokeWeight:1.5,strokeOpacity:1,strokeStyle:"solid",fillColor:y[0],fillOpacity:.5};var n=new daum.maps.Circle(r);n.setMap(h);x.push(n);var a=d.name?t[d.name.field]:_?t[d.addr.field]:"Y: "+Y(t[d.lat.field])+"</br> X: "+Y(t[d.lng.field]);var s='<div class="jelly-chart-tooltip" style="padding:4px;font-size:12px;font-family:sans-serif;">'+'<div class="jelly-chart-key" style="font-weight:bold;">'+a+"</div>"+(m?'<div class="jelly-chart-value">'+d.radius.field+": "+Y(t[d.radius.field])+"</div>":"")+"</div>";var o=new daum.maps.InfoWindow({position:new daum.maps.LatLng(t[d.lat.field]+i/f,t[d.lng.field]),content:s});daum.maps.event.addListener(n,"mouseover",function(){o.open(h)});daum.maps.event.addListener(n,"mouseout",function(){o.close()});if(m&&p){var l=Y(t[d.radius.field]);var c=new daum.maps.CustomOverlay({position:e,clickable:true,zIndex:-1,content:'<div class="label" style="pointer-events:none;padding:4px;font-size:12px;font-family:sans-serif;">'+l+"</div>"});c.setMap(h)}})};if(_){var l=0;a.forEach(function(r){var t=r[d.addr.field];var e=function t(e,i){if(!e){r[no.field]=i.lat;r[ao.field]=i.lng}l+=1;n.call("loading",this,l);if(l===a.length){s();o();n.call("end")}};try{eo(t,i,e)}catch(t){e(t)}})}else{s();o()}if(!m){daum.maps.event.addListener(h,"zoom_changed",function(){var e=g.range[0]*Math.pow(2,h.getLevel());x.forEach(function(t){t.setRadius(e)})})}}var no={field:"__--jelly-lat--__"};var ao={field:"__--jelly-lng--__"};var so={range:[.5,4],scale:"linear",reverse:false};var oo=["normal","point"];var lo={addr:false,mapBaseType:"ROADMAP",needCanvas:false,overlayMapType:null,size:so};var co=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(lo);t.__execs__.dispatch=X.dispatch("loading","end");i(t,t.__execs__.dispatch);t.process("munge",Qs,{isPre:true}).process("domain",to,{isPre:true}).process("map",$s).process("mark",ro);return t}n(e,[{key:"isSized",value:function t(){return this.condition()===oo[0]}}]);return e}(gi);co.prototype.addr=c("addr");co.prototype.mapBaseType=c("mapBaseType");co.prototype.overlayMapType=c("overlayMapType");var uo=m(co);function fo(){var n=this;var a=this.__execs__.scale;var t=this.__execs__.field,e=t.yBar,i=t.yLine;var r=this.axisX();var s=this.axis().find(function(t){return t.target==="y"&&t.orient==="left"});var o=this.axis().find(function(t){return t.target==="y"&&t.orient==="right"});var l=this.__execs__.field;var c=function t(e){e.field=l.x.field();var i=n.axisDefault(a.x,e);if(e.orient==="bottom")i.y(a.yBar.range()[0]);return i};var u=function t(e,i){var r=n.axisDefault(e,i);if(i.orient==="right")r.x(a.x.range()[1]);return r};if(r){c(r)}if(s){s.field=e.field();o.field=i.field();u(a.yBar,s);u(a.yLine,o)}this.renderAxis()}function ho(){var t=function t(e,i){var r=this.__execs__.field;if(e.length===1&&i.length===2){r.x=Xr(e[0]);r.yBar=I(i[0]);r.yLine=I(i[1]);r.region=Xr(this.mixedDimension());return ko[0]}else throw new x};this.condition(t);this.__execs__.munged=this.aggregate()}function vo(t){var e=this.__execs__.munged;var i=this.__execs__.field,r=i.x,n=i.yBar,a=i.yLine;var s=this.axisY();if(s&&s.orient==="left"){var o=Object.assign({},s);o.orient="right";this.axis(o)}var l=r.level(0).munged(e).domain(this.sortByValue());var c=this.scale();c.x=X.scaleBand().padding(this.padding()).domain(l);c.yBar=X.scaleLinear();c.yLine=X.scaleLinear();this.setCustomDomain("yBar",sn(n,e));this.setCustomDomain("yLine",xa(a,e));c.color=this.updateColorScale(this.measures().map(function(t){return t.field}),t)}function _o(){var t=this.scale(),e=t.x,i=t.yBar,r=t.yLine;var n=this.axisX();var a=this.axis().find(function(t){return t.target==="y"&&t.orient==="left"});var s=this.axis().find(function(t){return t.target==="y"&&t.orient==="right"});if(a){this.thickness(a,i,false,false);this.thickness(s,r,false,false)}if(n){this.thickness(n,e,true,true)}var o=this.innerSize(),l=o.width,c=o.height;i.range([c,0]);r.range([c,0]);e.range([0,l]);return this}function po(){var t=this.__execs__.scale;this.renderRegion(function(t){return t.x=t.y=0},t.color.domain().map(function(t){return{key:t}}))}function mo(){var t=this.legend();if(!t)return;this.renderLegend()}function go(){var e=this;var i=this;var r=this.data();var t=this.__execs__.field;var n=this.color();var a=this.innerSize();var s=this.font();var o=a.width,l=a.height;var c=this.padding();var u=this.dimensions();var f=[t.yBar.toObject()];var h=["axisTitles","padding","font","label","grid"].map(function(t){return{key:t,value:e[t]()}});var d=[t.yLine.toObject()];var v=["axisTitles","curve","point","pointRatio","regionPadding","size","grid","font","label"].map(function(t){return{key:t,value:i[t]()}});var _=function t(){var e=ka().container(this).data(r).dimensions(u).measures(d).width(o).height(l).font(s).legend(false).tooltip(false).padding(c).parent(i).zeroOffset(true).color(n[1]).scaleBandMode(true);v.forEach(function(t){return e[t.key](t.value)});e.render()};var p=function t(){var e=on().container(this).data(r).dimensions(u).measures(f).width(o).height(l).padding(c).legend(false).tooltip(false).zeroOffset(true).parent(i).color(n[0]);h.forEach(function(t){e[t.key](t.value)});e.render()};this.regions().each(function(t,e){if(e===0)X.select(this).each(p);else X.select(this).each(_)})}function yo(){if(!this.tooltip())return;var n=this.__execs__.field;var t=function t(e){return{name:"key",value:e.data.key}};var e=function t(e,i){var r=e.anchor?n.yLine.field():n.yBar.field();return{name:r,value:i}};this.renderTooltip({value:e,key:t})}var xo={range:[2,2],scale:"linear",reverse:false};var ko=["normal"];var wo={padding:.05,point:false,pointRatio:3,regionPadding:.1,size:xo};var bo=function(t){s(e,t);function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.setAttrs(wo);t.process("munge",ho,{isPre:true}).process("domain",vo,{isPre:true}).process("range",_o,{isPre:true}).process("region",po).process("facet",go).process("axis",fo).process("legend",mo).process("tooltip",yo);return t}n(e,[{key:"measureName",value:function t(){var e=this.measures();var i=void 0;if(this.condition()===ko[2])i=R.field;else if(this.aggregated()&&e[0].field===R.field)i=e[0].field;else i=e[0].field+"-"+e[0].op;return i}},{key:"isCount",value:function t(){return this.condition()===ko[1]}}]);return e}(_(fr).with(gr,mn,wr));var zo=m(bo);var Ao={bar:on,line:ka,scatter:Va,xyHeatmap:$a,treemap:fs,parCoords:Rs,pie:Us,markerMap:uo,combo:zo};Ao.type=function(t){if(Ao.hasOwnProperty(t))return Ao[t];throw new Error("Undefined type: "+t+" is not available")};return Ao});